<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Mathematical Modelling of Infectious Diseases</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="BF_measles_files/libs/clipboard/clipboard.min.js"></script>
<script src="BF_measles_files/libs/quarto-html/quarto.js"></script>
<script src="BF_measles_files/libs/quarto-html/popper.min.js"></script>
<script src="BF_measles_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="BF_measles_files/libs/quarto-html/anchor.min.js"></script>
<link href="BF_measles_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="BF_measles_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="BF_measles_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="BF_measles_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="BF_measles_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to Mathematical Modelling of Infectious Diseases</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="preface" class="level1">
<h1>Preface</h1>
<p>This document is prepared for the participants of the Outbreak Analytics in R course, organized by the Epiverse-TRACE team. Its purpose is to provide a concise introduction to the mathematical theory behind modeling infectious epidemics. We will use the Susceptible, Exposed, Infected, and Recovered (<strong>SEIR</strong>) model, applicable to diseases like measles, mumps, rubella, as an example.</p>
</section>
<section id="secanrio" class="level1">
<h1>Secanrio</h1>
<p>SSuppose a new infection has been detected in a closed community of <span class="math inline">\(\mathbf{N}\)</span> individuals, with the infection diagnosed in a single individual. The remaining <span class="math inline">\(\mathbf{N-1}\)</span> individuals are all at risk of getting the infection and are considered susceptible (<span class="math inline">\(\mathbf{S}\)</span>). An infected person interacts, on average per time unit (e.g., a day, week, or month), with some <span class="math inline">\(\mathbf{k}\)</span> individuals within the community. In particular, the infected person interacts with <span class="math inline">\(\frac{\mathbf{K\cdot S}}{\mathbf{N}}\)</span> susceptible individuals, among whom <span class="math inline">\(\mathbf{k}' \leq \mathbf{k}\)</span> may become infected. If the infection is highly contagious, <span class="math inline">\(\mathbf{k}'\)</span> will be closer to <span class="math inline">\(\mathbf{k}\)</span>, and vice versa. The probability of transmission is calculated as <span class="math inline">\(\mathbfcal{P}= \frac{\mathbf{k}'}{\mathbf{k}}.\)</span> Consequently, on average, the infected individual will infect <span class="math inline">\(\beta\cdot \frac{\mathbf{S}}{\mathbf{N}}\)</span> susceptible individuals per time unit, where <span class="math inline">\(\beta = \mathbfcal{P} \cdot \mathbf{k}\)</span> is called the effective transmission rate. This represents the average rate at which an infected individual can transmit the infection to a susceptible individual.</p>
<p>Depending on the nature of the disease, a newly infected individual may take time to show symptoms. This time period is known as the incubation period. Susceptible individuals who come into contact with an infected person and acquire the infection first move to an intermediate state called exposed (<span class="math inline">\(\mathbf{E}\)</span>). T here they (he/she) spent, on average, <span class="math inline">\(\frac{1}{\omega}\)</span> units time (the incubation period) and then move to the infected class (<span class="math inline">\(\mathbf{I}\)</span>) at a constant rate <span class="math inline">\(\omega\)</span>. Infected individuals are removed (either by recovery or death) from <span class="math inline">\(I\)</span> at a constant rate <span class="math inline">\(\gamma\)</span>, with <span class="math inline">\(\frac{1}{\gamma}\)</span> representing the average recovery duration. Upon recovery, they gain lifelong immunity against the current infection, meaning they do not become susceptible again, and they move to the recovered class (<span class="math inline">\(\mathbf{R}\)</span>) (see <a href="#fig-seir" class="quarto-xref">Figure&nbsp;1</a>).</p>
<p><img src="fig/t0.drawio.png" class="img-fluid" data-ref-parent="fig-seir"> <img src="fig/t1.drawio.png" class="img-fluid" data-ref-parent="fig-seir"> <img src="fig/t2.drawio.png" class="img-fluid" data-ref-parent="fig-seir"> <img src="fig/t3.drawio.png" class="img-fluid" data-ref-parent="fig-seir"></p>
<p>The four classes considered define the <span class="math inline">\(\mathbf{SEIR}\)</span> model. The sizes of these classes change overtime and thus are functions of time <span class="math inline">\(t\)</span>, and the total population at any time <span class="math inline">\(t\)</span> is <span class="math inline">\(N(t)=  S(t) + E(t) + I(t)+ R(t)\)</span>. The rates of change between these classes are captured mathematically through four differential equations as follows:</p>
<p><span id="eq-s1"><span class="math display">\[
\begin{eqnarray}
\frac{dS}{dt} &amp;=&amp; -\beta \cdot \frac{S\cdot I}{N} &amp; &amp;​ \\
\frac{dE}{dt} &amp;=&amp;\beta\cdot  \frac{S\cdot I}{N}​ &amp;-&amp; \omega\cdot  E\\
\frac{dI}{dt} &amp;=&amp; \omega \cdot E &amp;-&amp; \gamma \cdot I​ \\
\frac{dR}{dt} &amp;=&amp; \gamma \cdot I​  &amp; &amp;\\
\end{eqnarray}
\qquad(1)\]</span></span></p>
<p>At time <span class="math inline">\(t_0=0\)</span>, there is one infected person (<span class="math inline">\(\mathbf{I}_0 =1\)</span>), while all other individuals remain susceptible (<span class="math inline">\(\mathbf{S}_0= \mathbf{N} -\mathbf{I}_0 = \mathbf{N} -1\)</span>). Initially, there are no exposed or recovered individuals (<span class="math inline">\(\mathbf{E}_0= 0\)</span> and <span class="math inline">\(\mathbf{R}_0 = 0\)</span>). These are known as the initial values of the system in <a href="#eq-s1" class="quarto-xref">Equation&nbsp;1</a>.</p>
<p>Solving <a href="#eq-s1" class="quarto-xref">Equation&nbsp;1</a> involves determining the values of the compartments at any time <span class="math inline">\(t&gt;t_0\)</span>​, starting from the initial conditions. Since the compartments represent individuals, their values must always be non-negative. This characteristic is referred to as the positivity of the solution.</p>
<p>Before, delving into mathematical details of how to solve <a href="#eq-s1" class="quarto-xref">Equation&nbsp;1</a>, a few key observations can be made:</p>
<ol type="1">
<li><p>At the onset of an epidemic, the number of susceptible individuals begins to decrease exponentially, while the number of exposed and infectious individuals increases. As the epidemic progresses, the susceptible population becomes depleted, and the exposed and infectious groups reach their peak before starting to decline. Meanwhile, the number of recovered individuals continues to increase without decreasing.</p></li>
<li><p>The infection will take off only when <span class="math inline">\(\frac{\mathbf{dE}}{dt} &gt; 0\)</span> and <span class="math inline">\(\frac{\mathbf{dI}}{dt} &gt; 0\)</span>, and taking the values of these two terms from <a href="#eq-s1" class="quarto-xref">Equation&nbsp;1</a> leads to</p></li>
</ol>
<p><span id="eq-s2"><span class="math display">\[
\begin{eqnarray}
\beta \cdot \frac{S\cdot I}{N}​ &amp;-&amp; \omega \cdot E &gt; 0\\
\omega\cdot  E &amp;-&amp; \gamma \cdot I​ &gt; 0.
\end{eqnarray}
\qquad(2)\]</span></span> Adding the two equations in <a href="#eq-s2" class="quarto-xref">Equation&nbsp;2</a>, gives <span class="math inline">\(\frac{\beta}{\gamma} &gt; \frac{\mathbf{N}}{\mathbf{S}}\)</span>. At time <span class="math inline">\(t=0\)</span>, we have <span class="math inline">\(\mathbf{S} = \mathbf{N}-1 \approx  \mathbf{N}\)</span>. Therefore, the infection with take off <span class="math inline">\(\frac{\beta}{\gamma} &gt; 1\)</span>. This is a very interesting observation –It tells that the disease cases will increase if the ratio of new infections to recovered cases is greater than 1.</p>
<ol start="3" type="1">
<li><p>The ratio <span class="math inline">\(\frac{\beta}{\gamma}\)</span> represents the basic reproduction number, <span class="math inline">\(\mathbfcal{R}_0\)</span>, which is defined as the average number of new infections caused by a single infected individual in a fully susceptible population. <span class="math inline">\(\mathbfcal{R}_0\)</span> is a crucial metric for understanding the transmissibility of an infectious disease. A higher value of <span class="math inline">\(\mathbfcal{R}_0\)</span> indicates a more transmissible disease, leading to a faster spread within the community.</p></li>
<li><p>The <span class="math inline">\(\mathcal{R}_0\)</span> value helps to determine the finalsize- the total number of individuals that that will be infected- of the outbreak via the following equation <span id="eq-fs"><span class="math display">\[
\begin{equation}
z = 1 - e^{-\mathcal{R}_0 \cdot z}
\end{equation}
\qquad(3)\]</span></span></p></li>
</ol>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(z\)</span> is the final size (the fraction of the population infected),</p></li>
<li><p><span class="math inline">\(\mathcal{R}_0\)</span> is the basic reproduction number, and</p></li>
<li><p><span class="math inline">\(e\)</span> is the base of the natural logarithm.</p></li>
</ul>
<ol start="5" type="1">
<li>Additionally, the basic reproduction number <span class="math inline">\(\mathcal{R}_0\)</span> is crucial for determining the herd immunity threshold (HIT), which represents the minimum proportion of the population that must be immune (either through vaccination or previous infection) in order to contain the epidemic and prevent widespread transmission. The formula for the herd immunity threshold is: <span id="eq-hit"><span class="math display">\[ HIT = 1 - \frac{1}{\mathcal{R}_0} \qquad(4)\]</span></span></li>
</ol>
<p>Where:</p>
<ul>
<li>HIT is the proportion of the population that needs to be immune to achieve herd immunity,</li>
</ul>
<p>As <span class="math inline">\(\mathcal{R}_0\)</span> increases, the herd immunity threshold also increases, meaning a larger proportion of the population must be immune to prevent the epidemic from spreading.</p>
</section>
<section id="measles-outbreak-in-burkina-faso" class="level1">
<h1>Measles Outbreak in Burkina Faso</h1>
<section id="backaground" class="level2">
<h2 class="anchored" data-anchor-id="backaground">Backaground</h2>
<p>Measles is a highly contagious viral disease that spreads quickly, particularly in environments where people live or gather in close quarters, such as schools, healthcare facilities, or densely populated urban areas. Transmission occurs through respiratory droplets when an infected person coughs or sneezes, and the virus can remain viable in the air for up to two hours. Effective vaccines are available, offering an efficacy of 93% to 97%, making vaccination a key tool in controlling measles outbreaks.</p>
<p>Given the virus’s high transmissibility, even a single case of measles can trigger large outbreaks, especially in regions with low vaccination coverage. The incubation (pre-infectious) period for measles is typically around 8 days, [while the infectious period averages 5 days][masters2023measles]. The SEIR model in <a href="#eq-s1" class="quarto-xref">Equation&nbsp;1</a> is commonly employed to simulate the dynamics of measles outbreaks and evaluate control measures like vaccination</p>
</section>
<section id="burkina-faso-situation-in-jan-2024" class="level2">
<h2 class="anchored" data-anchor-id="burkina-faso-situation-in-jan-2024">Burkina Faso Situation in Jan 2024</h2>
<p>Burkina Faso, like many other countries in Africa, faces recurring measles outbreaks. This can be attributed to factors such as limited healthcare access, inadequate vaccination coverage, and fragile healthcare systems. In 2023, Burkina Faso experienced a particularly severe outbreak, [with over 2,000 suspected cases reported][crisis24], prompting health authorities and international organizations to scale up [vaccination campaigns in an effort to curtail the spread of the disease][savethechildren, thecable].</p>
<p>We will simulate the measles outbreak in Burkina Faso using the SEIR model in <a href="#eq-s1" class="quarto-xref">Equation&nbsp;1</a>. This will allow us to explore the outbreak dynamics with and without vaccination. For this purpose, we will use the <strong>R</strong> package <code>{epidemics}</code>, which is designed for modeling infectious disease spread.</p>
</section>
<section id="baseline-model" class="level2">
<h2 class="anchored" data-anchor-id="baseline-model">Baseline Model</h2>
<p><strong>Model Assumptions and Parameters</strong></p>
<ol type="1">
<li><p><strong>Total Population</strong>: The population of Burkina Faso is approximately <span class="math inline">\(N\approx 22.67\)</span> million.</p></li>
<li><p><strong>Population Structure</strong>:</p>
<ul>
<li><p><strong>No Age Stratification</strong>: Assume the population is homogeneous with respect to age. This means that all individuals, regardless of age, have the same susceptibility to measles and contribute equally to the transmission dynamics.</p></li>
<li><p><strong>Highly Mixed Community</strong>: Assume the population is well-mixed and the transmission occurs uniformly across the entire population. Meaning that every individual has an equal probability of coming into contact with any other individual. This implies that geographic or social structures (like clustering within families, schools, or neighborhoods) are not considered.</p></li>
</ul></li>
<li><p><strong>Initial Conditions</strong>:</p>
<ul>
<li>A single infectious case is introduced into the population: <span class="math inline">\(I_0 = 1\)</span>.</li>
<li>The entire population, except for this one case, is initially susceptible: <span class="math inline">\(S_0 = N - 1\)</span>.</li>
<li>No individuals are in the exposed stage at the start: <span class="math inline">\(E_0 = 0\)</span>.</li>
<li>No individuals have recovered: <span class="math inline">\(R_0 = 0\)</span>.</li>
</ul></li>
<li><p><strong>Incubation Period</strong>: The average incubation period for measles is around 8 days (the time period between exposure and becoming infectious), so the transition rate from exposed to infectious individuals is: <span class="math inline">\(\omega = \frac{1}{8}\)</span>.</p></li>
<li><p><strong>Infectious Period</strong>: The average infectious period lasts for 5 days, which means the recovery rate is: <span class="math inline">\(\gamma = \frac{1}{5}\)</span></p></li>
<li><p><strong>Basic Reproduction Number</strong> <span class="math inline">\(\mathcal{R}_0\)</span>:</p>
<ul>
<li><span class="math inline">\(\mathcal{R}_0 =15\)</span> (for measles this value typically ranges from 12 to 18).</li>
<li>This makes the transmission rate <span class="math inline">\(\beta = \mathbfcal{R}_0\cdot\gamma = 3\)</span></li>
<li>This means each infectious individual causes 3 new infections per day in a fully susceptible population.</li>
</ul></li>
</ol>
<p>By applying these assumptions and parameters to <a href="#eq-s1" class="quarto-xref">Equation&nbsp;1</a>, we can simulate the potential trajectory of the measles outbreak using the syntax provided by the {epidemics} package as shown in the below is code chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epidemics)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the population structure for Burkina Faso</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>bfaso <span class="ot">&lt;-</span> <span class="fu">population</span>(</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"Burkina Faso"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">contact_matrix =</span> <span class="fu">matrix</span>(<span class="dv">1</span>),  <span class="co"># Well-mixed population</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">demography_vector =</span> <span class="fl">22.67e6</span>,  <span class="co"># Population size</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_conditions =</span> <span class="fu">matrix</span>(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="fl">22.67e6</span>, <span class="dv">1</span><span class="sc">/</span><span class="fl">22.67e6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),  <span class="co"># Initial conditions: Susceptible, exposed, Infectious, vaccinated, and recovered</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">5</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the SEIR model simulation</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">model_default</span>(</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">population =</span> bfaso,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">transmission_rate =</span> <span class="dv">15</span><span class="sc">/</span><span class="dv">5</span>,  <span class="co"># R0/infectious period = 15/5 = 3</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">infectiousness_rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>,  <span class="co"># 1/incubation period (pre-infectious phase)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">recovery_rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>,  <span class="co"># 1/infectious period</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_end =</span> <span class="dv">120</span>,  <span class="co"># Simulation over 120 days</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">increment =</span> <span class="dv">1</span>  <span class="co"># Daily increments</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the epidemic curve for susceptible, exposed, infectious, and recovered</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(output, </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>       compartment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"exposed"</span>, <span class="st">"infectious"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> time,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> value <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span>,  <span class="co"># Scale to millions</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> compartment,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> compartment</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Simulation Time (days)"</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Individuals (in millions)"</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"The dynamics of SIER model with "</span>, <span class="fu">italic</span>(R)[<span class="dv">0</span>], <span class="st">"= 15, "</span>, <span class="st">" showing the trajectories of number of exposed and infected individuals"</span>))</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="fig/unnamed-chunk-1-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="expected-epidemic-size-herd-immunity" class="level2">
<h2 class="anchored" data-anchor-id="expected-epidemic-size-herd-immunity">Expected Epidemic Size &amp; Herd Immunity</h2>
<p>Using the <code>{finalsize}</code> package implements <a href="#eq-fs" class="quarto-xref">Equation&nbsp;3</a> for calculate the expected proportion of the population that will be infected given a specified basic reproduction number <span class="math inline">\((\mathcal{R}_0)\)</span>. The calculation can be done as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the finalsize library</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalsize)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>finalsize<span class="sc">::</span><span class="fu">final_size</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    demo_grp   susc_grp susceptibility p_infected
1 demo_grp_1 susc_grp_1              1  0.9999546</code></pre>
</div>
</div>
<p>For <span class="math inline">\(\mathcal{R}_0 \geq 10\)</span>, the results indicate that nearly the entire population is expected to be infected by measles. The <span class="math inline">\(HIT\)</span> needed to contains the epidemic is about <span class="math inline">\(93\%\)</span>, uaing the formula given in <a href="#eq-hit" class="quarto-xref">Equation&nbsp;4</a>.</p>
</section>
</section>
<section id="age-structured-model" class="level1">
<h1>Age-Structured Model</h1>
<p>The age structure of Burkina Faso is characteristic of a young population, with a majority of the population being under 25 years old. [According to recent estimates][un_population_prospects, cia_world_factbook_bf, world_bank_population_data], the age structure is broken down as follows:</p>
<ul>
<li><span class="math inline">\([0\to15)\)</span> years: ~ 44 (43-45)% of the population</li>
<li><span class="math inline">\([15\to 25)\)</span> years: ~19.5 (19-20)%</li>
<li><span class="math inline">\([25\to 55)\)</span> years: ~29 (28-30)%</li>
<li><span class="math inline">\([55\to 65)\)</span> years: ~5 (3-5)%</li>
<li><span class="math inline">\(65+\)</span> : ~2.5 (2-3)%</li>
</ul>
<section id="contact-matrix" class="level2">
<h2 class="anchored" data-anchor-id="contact-matrix"><strong>Contact Matrix</strong></h2>
<p>A contact matrix typically consists of rows and columns representing different age groups, where each cell indicates the average number of contacts between individuals of the age group corresponding to that row and column.</p>
<p>Although we do not have a direct access for contact matrix for Burkina Faso, we can resort for a hypothetical contact matrix based on general assumptions about high contact rates among younger populations and lower rates among older age groups:</p>
<table class="caption-top table">
<caption>Table for a <strong>hypothetical</strong> mean contacts between different age groups in Burkina Faso population.</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: left;"><strong>[0-15)</strong></th>
<th style="text-align: left;"><strong>[15-25)</strong></th>
<th style="text-align: left;"><strong>[25-54)</strong></th>
<th style="text-align: left;"><strong>[55-65)</strong></th>
<th style="text-align: left;"><strong>65+</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>[0-15)</strong></td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td><strong>[15-25)</strong></td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td><strong>[25-55)</strong></td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td><strong>[55-65)</strong></td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="odd">
<td><strong><span class="math inline">\(65+\)</span></strong></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">10</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial conditions: one in every 1 million is infected</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>bf_pop <span class="ot">&lt;-</span> <span class="fl">22.67e6</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>contact_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">1</span>,   <span class="co"># Contacts from 0-14 years</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">2</span>,   <span class="co"># Contacts from 15-24 years</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">6</span>, <span class="dv">3</span>,    <span class="co"># Contacts from 25-54 years</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">5</span>,     <span class="co"># Contacts from 55-64 years</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>),    <span class="co"># Contacts from 65+ years</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">5</span>,              <span class="co"># Number of rows</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span>,          <span class="co"># Fill the matrix by rows</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"[0-15)"</span>, <span class="st">"[15-25)"</span>, <span class="st">"[25-55)"</span>, <span class="st">"[55-65)"</span>, <span class="st">"65+"</span>),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"[0-15)"</span>, <span class="st">"[15-25)"</span>, <span class="st">"[25-55)"</span>, <span class="st">"[55-65)"</span>, <span class="st">"65+"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the demography vector for Burkina Faso</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>demography_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.44</span>, <span class="fl">0.195</span>, <span class="fl">0.29</span>, <span class="fl">0.05</span>, <span class="fl">0.025</span>) <span class="sc">*</span> bf_pop</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(demography_vector) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(contact_matrix)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(demography_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [0-15) [15-25) [25-55) [55-65)     65+ 
9974800 4420650 6574300 1133500  566750 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scale the contact matrix so the largest eigenvalue is 1.0</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this is to ensure that the overall epidemic dynamics correctly reflect</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the assumed value of R0</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>contact_matrix <span class="ot">&lt;-</span> contact_matrix <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">Re</span>(<span class="fu">eigen</span>(contact_matrix)<span class="sc">$</span>values))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># divide each row of the contact matrix by the corresponding demography</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this reflects the assumption that each individual in group {j} make contacts</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># at random with individuals in group {i}</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>contact_matrix <span class="ot">&lt;-</span> contact_matrix <span class="sc">/</span> demography_vector</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the contact matrix</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#print(contact_matrix)</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the population structure for Burkina Faso</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>initial_i <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> bf_pop</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>initial_conditions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">S =</span> <span class="dv">1</span> <span class="sc">-</span> initial_i, <span class="at">E =</span> <span class="dv">0</span>, <span class="at">I =</span> initial_i, <span class="at">R =</span> <span class="dv">0</span>, <span class="at">V =</span> <span class="dv">0</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Replicate initial conditions for all age groups</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>initial_conditions_matrix <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  initial_conditions,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  initial_conditions,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  initial_conditions,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  initial_conditions,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  initial_conditions</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(initial_conditions_matrix) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(contact_matrix)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#print(initial_conditions_matrix)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the population object</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>bf_population <span class="ot">&lt;-</span> <span class="fu">population</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"Burkina Faso"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">contact_matrix =</span> contact_matrix,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">demography_vector =</span> demography_vector,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">initial_conditions =</span> initial_conditions_matrix</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the epidemic model</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">model_default</span>(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">population =</span> bf_population,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">transmission_rate =</span> <span class="dv">15</span> <span class="sc">/</span> <span class="dv">5</span>,  <span class="co"># R0/infectious period = 15/5 = 3</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">infectiousness_rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">8</span>,  <span class="co"># 1/incubation period (pre-infectious phase)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">recovery_rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">5</span>,  <span class="co"># 1/infectious period</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_end =</span> <span class="dv">122</span>,  <span class="co"># Simulation over 122 days</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">increment =</span> <span class="dv">1</span>  <span class="co"># Daily increments</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the epidemic curve</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>output <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(compartment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"exposed"</span>, <span class="st">"infectious"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> time,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> value,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> demography_group,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> compartment</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>, <span class="at">name =</span> <span class="st">"Age group"</span>) <span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">500e3</span>)) <span class="sc">+</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,  </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">lineheight =</span> <span class="dv">121</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Simulation time (days)"</span>,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Compartment"</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Individuals"</span>,</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"SIER model showing the trajectories of the number of exposed and infected individuals "</span>, <span class="fu">italic</span>(R)[<span class="dv">0</span>], <span class="st">" = 15 for different age groups."</span>))</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="fig/unnamed-chunk-4-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="effective-reproduction-number-mathcalr_eff" class="level3">
<h3 class="anchored" data-anchor-id="effective-reproduction-number-mathcalr_eff">Effective Reproduction Number <span class="math inline">\(\mathcal{R}_{eff}\)</span></h3>
<p>Age-structured models account for heterogeneous characteristics in the population, such as:</p>
<ul>
<li>Demographic differences in social contacts,</li>
<li>Variations in demographic distribution, and</li>
<li>Differences in susceptibility to infection.</li>
</ul>
<p>These factors result in different <span class="math inline">\(\mathcal{R}_0\)</span> values for each age group. The <strong>effective reproduction number</strong> <span class="math inline">\(\mathcal{R}_{eff}\)</span> represents the overall reproduction number across all age groups while accounting for these differences. It is calculated using the following formula:</p>
<p><span id="eq-reff"><span class="math display">\[
\begin{equation}
\mathcal{R}_{eff} = \rho(C) \times \lambda \times \gamma
\end{equation}
\qquad(5)\]</span></span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(\rho(C)\)</span> is the <strong>largest eigenvalue</strong> of the contact matrix <span class="math inline">\(C\)</span>, which is derived from the social contact patterns, scaled by the population distribution across different demographic and susceptibility groups.</p></li>
<li><p><span class="math inline">\(\lambda\)</span> is the <strong>force of infection</strong>, which measures the rate at which susceptible individuals are infected. This is distinct from the effective transmission rate, often denoted as <span class="math inline">\(\beta\)</span>.</p></li>
<li><p><span class="math inline">\(\gamma\)</span> represents the <strong>infectious period</strong>, which is the average duration an individual remains infectious.</p></li>
</ul>
<p>The <code>{finalsize}</code>package implements <a href="#eq-reff" class="quarto-xref">Equation&nbsp;5</a>, and we can use it to calculate the <span class="math inline">\(\mathcal{R}_{eff}\)</span> for our age-structured model, as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>r0 <span class="ot">&lt;-</span>  <span class="dv">15</span> <span class="co">#  basic reproduction number </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># define the number of age and susceptibility groups</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>n_demo_grps <span class="ot">&lt;-</span> <span class="fu">length</span>(demography_vector)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>n_risk_grps <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># In this example, risk varies across groups</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>susceptibility <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">c</span>(<span class="fl">0.80</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>), <span class="at">nrow =</span> n_demo_grps, <span class="at">ncol =</span> n_risk_grps</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># risk does not vary within groups</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>p_susceptibility <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="dv">1</span>, <span class="at">nrow =</span> n_demo_grps, <span class="at">ncol =</span> n_risk_grps</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># p_susceptibility rows must sum to 1.0</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>p_susceptibility <span class="ot">&lt;-</span> p_susceptibility <span class="sc">/</span> <span class="fu">rowSums</span>(p_susceptibility)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>reff <span class="ot">&lt;-</span> <span class="fu">r_eff</span>(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">r0 =</span> r0,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">contact_matrix =</span> contact_matrix,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">demography_vector =</span> demography_vector,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">susceptibility =</span> susceptibility,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_susceptibility =</span> p_susceptibility</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(reff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.529089</code></pre>
</div>
</div>
</section>
<section id="mathcalr_eff-vs-mathcalr_0" class="level3 callout-question">
<h3 class="anchored" data-anchor-id="mathcalr_eff-vs-mathcalr_0"><span class="math inline">\(\mathcal{R}_{eff}\)</span> vs <span class="math inline">\(\mathcal{R}_0\)</span></h3>
<p>How different is the <span class="math inline">\(\mathcal{R}_{eff}\)</span> value from <span class="math inline">\(\mathcal{R}_0\)</span>?</p>
</section>
</section>
</section>
<section id="interventions-models" class="level1">
<h1>Interventions models</h1>
<p>Interventions against measles include prevention, control, and treatment. Controlling its spread requires a combination of public health measures, such as reducing contact, isolating infectious and exposed individuals, and vaccination. In this section, we will simulate the SEIR model with interventions using the <code>{epidemics}</code> package.</p>
<section id="contacts-reduction-model" class="level2">
<h2 class="anchored" data-anchor-id="contacts-reduction-model">Contacts Reduction Model</h2>
<p>Reducing contact by a certain percentage, say (20%), impacts the transmission rate <span class="math inline">\(( \beta )\)</span>. This reduction can be achieved through measures such as quarantine, limiting public gatherings, and regular screening in healthcare settings. To include such interventions in the baseline SEIR model, the <code>{epidemics}</code> package provides an object called <code>interventions</code>, which is added to the model definition as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>reduced_contacts <span class="ot">&lt;-</span> <span class="fu">intervention</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"reduce"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"rate"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_begin =</span> <span class="dv">30</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_end =</span> <span class="dv">30</span> <span class="sc">+</span> <span class="dv">60</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="fl">0.2</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the epidemic model</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>output2 <span class="ot">&lt;-</span> epidemics<span class="sc">::</span><span class="fu">model_default</span>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">population =</span> bf_population,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">transmission_rate =</span> <span class="dv">15</span> <span class="sc">/</span> <span class="dv">5</span>,  <span class="co"># R0/infectious period = 15/5 = 3</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">infectiousness_rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">8</span>,  <span class="co"># 1/incubation period (pre-infectious phase)</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">recovery_rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">5</span>,  <span class="co"># 1/infectious period</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervention =</span> <span class="fu">list</span>(<span class="at">transmission_rate =</span> reduced_contacts),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_end =</span> <span class="dv">120</span>,  <span class="co"># Simulation over 75 days</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">increment =</span> <span class="dv">1</span>  <span class="co"># Daily increments</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To examine the effect that implementing a reduction in contact has on the daily number of new infections, we plot the results from the two models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load new infections data for each scenario</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_baseline <span class="ot">&lt;-</span> <span class="fu">new_infections</span>(output, <span class="at">by_group =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>data_reduced <span class="ot">&lt;-</span> <span class="fu">new_infections</span>(output2, <span class="at">by_group =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign scenario names</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>data_baseline<span class="sc">$</span>scenario <span class="ot">&lt;-</span> <span class="st">"Baseline"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>data_reduced<span class="sc">$</span>scenario <span class="ot">&lt;-</span> <span class="st">"Reduced Contact"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the data from both scenarios</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_baseline, data_reduced)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot new infections over time with scenario and demographic groups</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_combined) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> new_infections, <span class="at">col =</span> demography_group, <span class="at">linetype =</span> scenario)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Highlight the reduced contact intervention period</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"rect"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> reduced_contacts[[<span class="st">"time_begin"</span>]],</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> reduced_contacts[[<span class="st">"time_end"</span>]],</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="fl">0.67e3</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"red"</span>, <span class="fl">0.2</span>),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set axis scaling and formatting</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Scenario"</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Baseline"</span> <span class="ot">=</span> <span class="st">"dashed"</span>,</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Reduced Contact"</span> <span class="ot">=</span> <span class="st">"solid"</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Dark2"</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age Group"</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1e3</span>)) <span class="sc">+</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Simulation Time (days)"</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"New Infections"</span>,</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Scenario"</span>, </span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"New infections under baseline and 20% reduced transmission rate ("</span>, beta, <span class="st">") for different age groups."</span>))</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust legend display to fit in two rows</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="fig/unnamed-chunk-7-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="vaccination-model" class="level3">
<h3 class="anchored" data-anchor-id="vaccination-model">Vaccination Model</h3>
<p>An effective vaccine for measles exists, known as the measles, mumps, and rubella (MMR) vaccine. The efficacy of the measles component of the MMR vaccine varies slightly depending on the age at which it is administered and the number of doses received. For example, the vaccine’s efficacy is approximately <span class="math inline">\(93\%\)</span>, <span class="math inline">\(97\%\)</span>, <span class="math inline">\(95\%\)</span>, <span class="math inline">\(94\%\)</span>, and <span class="math inline">\(85\%\)</span> for the age groups <span class="math inline">\([0\to 15)\)</span>, <span class="math inline">\([15\to 25)\)</span>, <span class="math inline">\([25\to 55)\)</span>, <span class="math inline">\([55\to 65)\)</span>, and <span class="math inline">\(65+\)</span>, respectively. The <code>{epidemics}</code> package enables the incorporation of vaccination interventions into modeling, as demonstrated in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vaccinate_elders <span class="ot">&lt;-</span> <span class="fu">vaccination</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"Vaccination compagain"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_begin =</span> <span class="fu">matrix</span>(<span class="dv">30</span>, <span class="fu">nrow</span>(contact_matrix)),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_end =</span> <span class="fu">matrix</span>(<span class="dv">90</span>, <span class="fu">nrow</span>(contact_matrix)),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nu =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.93</span>, <span class="fl">0.97</span>, <span class="fl">0.95</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span> ))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the epidemic model</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>output3 <span class="ot">&lt;-</span> epidemics<span class="sc">::</span><span class="fu">model_default</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">population =</span> bf_population,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">transmission_rate =</span> <span class="dv">15</span> <span class="sc">/</span> <span class="dv">5</span>,  <span class="co"># R0/infectious period = 15/5 = 3</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">infectiousness_rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">8</span>,  <span class="co"># 1/incubation period (pre-infectious phase)</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">recovery_rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">5</span>,  <span class="co"># 1/infectious period</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">vaccination =</span> vaccinate_elders,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_end =</span> <span class="dv">120</span>,  <span class="co"># Simulation over 120 days</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">increment =</span> <span class="dv">1</span>  <span class="co"># Daily increments</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the epidemic curve</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>output3 <span class="sc">%&gt;%</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(compartment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"exposed"</span>, <span class="st">"infectious"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> time,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> value,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> demography_group,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> compartment</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>, <span class="at">name =</span> <span class="st">"Age group"</span>) <span class="sc">+</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3e3</span>)) <span class="sc">+</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,  </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">lineheight =</span> <span class="dv">121</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Simulation time (days)"</span>,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Compartment"</span>,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Individuals"</span>,</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"SIER with vaccine  showing the trajectories of the number of exposed and infected individuals for different age groups."</span>))</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="fig/unnamed-chunk-8-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can visualize the outcomes of both the baseline model and the vaccine-intervention model to highlight the differences in infection dynamics. This comparison allows us to observe how vaccination impacts the spread of the disease, particularly in terms of reducing new infections, altering the epidemic curve, and potentially preventing outbreaks across different age groups. By contrasting these two models, we can better understand the effectiveness of vaccination strategies in controlling the epidemic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load new infections data for each scenario</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>data_vaccine <span class="ot">&lt;-</span> <span class="fu">new_infections</span>(output3, <span class="at">by_group =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign scenario names</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>data_vaccine<span class="sc">$</span>scenario <span class="ot">&lt;-</span> <span class="st">"Vaccination"</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the data from both scenarios (baseline and vaccination)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_baseline, data_vaccine)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot new infections over time by scenario and demographic groups</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_combined) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot new infections with lines for each demographic group and scenario</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> new_infections, <span class="at">col =</span> demography_group, <span class="at">linetype =</span> scenario)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Highlight the reduced contact intervention period using a shaded rectangle</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"rect"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> reduced_contacts[[<span class="st">"time_begin"</span>]],</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> reduced_contacts[[<span class="st">"time_end"</span>]],</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="fl">0.67e3</span>,  <span class="co"># Define the rectangle's limits</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"red"</span>, <span class="fl">0.2</span>),  <span class="co"># Semi-transparent red fill</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>  <span class="co"># Dashed border for the rectangle</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Scale the y-axis with comma-formatted labels</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define custom line types for scenarios</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Scenario"</span>,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Baseline"</span> <span class="ot">=</span> <span class="st">"dashed"</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Vaccination"</span> <span class="ot">=</span> <span class="st">"solid"</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use a color palette for age groups</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"Dark2"</span>,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Age Group"</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set axis limits and disable automatic expansion</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1e3</span>)) <span class="sc">+</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Apply a clean white background theme</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Customize theme for better aesthetics</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,  <span class="co"># Position legend at the top</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Adjust legend text size</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)  <span class="co"># Center align the caption</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add axis labels and caption for the plot</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Simulation Time (days)"</span>,  <span class="co"># x-axis label</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"New Infections"</span>,  <span class="co"># y-axis label</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"Scenario"</span>,  <span class="co"># Legend title for line types</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"New infections under baseline and vaccine-induced immunity with varying efficacy ("</span>, nu, <span class="st">") across different age groups."</span>))</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adjust legend display for better readability</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)  <span class="co"># Split legend into two rows</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="fig/unnamed-chunk-9-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="combining-interventions" class="level4">
<h4 class="anchored" data-anchor-id="combining-interventions">Combining interventions</h4>
<p>The <code>{epidemics}</code> package enables the integration of multiple interventions, such as vaccination and contact reduction, within a single model, allowing for more comprehensive simulations of disease control strategies. The below code chunk shows how to combine interventions together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the epidemic model</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>output4 <span class="ot">&lt;-</span> epidemics<span class="sc">::</span><span class="fu">model_default</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">population =</span> bf_population,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">transmission_rate =</span> <span class="dv">15</span> <span class="sc">/</span> <span class="dv">5</span>,  <span class="co"># R0 / infectious period = 3</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">infectiousness_rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">8</span>,  <span class="co"># 1 / incubation period (pre-infectious phase)</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">recovery_rate =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">5</span>,  <span class="co"># 1 / infectious period</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">intervention =</span> <span class="fu">list</span>(<span class="at">transmission_rate =</span> reduced_contacts),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vaccination =</span> vaccinate_elders,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_end =</span> <span class="dv">120</span>,  <span class="co"># Simulation over 75 days</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">increment =</span> <span class="dv">1</span>  <span class="co"># Daily increments</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the epidemic curve (infectious individuals)</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>output4 <span class="sc">%&gt;%</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(compartment <span class="sc">==</span> <span class="st">"infectious"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Filter for infectious individuals</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> time,  <span class="co"># Time on the x-axis</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> value,  <span class="co"># Number of infectious individuals on the y-axis</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> demography_group  <span class="co"># Color by demographic group (age)</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span>  <span class="co"># Line width for better visibility</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span>  <span class="co"># Format y-axis with commas for thousands</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>, <span class="at">name =</span> <span class="st">"Age Group"</span>) <span class="sc">+</span>  <span class="co"># Color palette for age groups</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5e3</span>)) <span class="sc">+</span>  <span class="co"># Ensure the y-axis starts from 0 and goes up to 500,000</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="co"># Disable axis expansion</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>  <span class="co"># Clean, white background theme</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,  <span class="co"># Place legend at the top</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">lineheight =</span> <span class="fl">1.1</span>),  <span class="co"># Adjust text size and line height</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)  <span class="co"># Center align the caption</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Simulation Time (Days)"</span>,  <span class="co"># x-axis label</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Infectious Individuals"</span>,  <span class="co"># y-axis label</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"SIER model with vaccination and contact reduction: Number of infectious individuals by age group"</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>)  <span class="co"># Split the legend into two rows for compactness</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="fig/unnamed-chunk-10-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>