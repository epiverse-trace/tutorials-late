<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Scenario modelling for outbreak analytics with R: Comparing vaccination strategies</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/epiverse-trace/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/epiverse-trace/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/epiverse-trace/favicon-16x16.png"><link rel="manifest" href="../favicons/epiverse-trace/site.webmanifest"><link rel="mask-icon" href="../favicons/epiverse-trace/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epiverse-trace"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epiverse-trace-logo" alt="epiverse-trace" src="../assets/images/epiverse-trace-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../vaccine-comparisons.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epiverse-trace" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epiverse-trace" src="../assets/images/epiverse-trace-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Scenario modelling for outbreak analytics with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Scenario modelling for outbreak analytics with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="BF_measles.html">Introduction to Mathematical Modelling of Infectious Diseases</a></li><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Scenario modelling for outbreak analytics with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 72%" class="percentage">
    72%
  </div>
  <div class="progress epiverse-trace">
    <div class="progress-bar epiverse-trace" role="progressbar" style="width: 72%" aria-valuenow="72" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../vaccine-comparisons.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="contact-matrices.html">1. Contact matrices</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="simulating-transmission.html">2. Simulating transmission</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="model-choices.html">3. Choosing an appropriate model</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="modelling-interventions.html">4. Modelling interventions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="compare-interventions.html">5. Comparing public health outcomes of interventions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        6. Comparing vaccination strategies
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#direct-and-indirect-effects-of-vaccination">Direct and indirect effects of vaccination</a></li>
<li><a href="#targeted-vaccination">Targeted vaccination</a></li>
<li><a href="#vaccination-versus-npis">Vaccination versus NPIs</a></li>
<li><a href="#summary">Summary</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="disease-burden.html">7. Modelling disease burden</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="BF_measles.html">Introduction to Mathematical Modelling of Infectious Diseases</a></li><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/compare-interventions.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/disease-burden.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/compare-interventions.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Comparing public
        </a>
        <a class="chapter-link float-end" href="../instructor/disease-burden.html" rel="next">
          Next: Modelling disease...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Comparing vaccination strategies</h1>
        <p>Last updated on 2025-02-04 |

        <a href="https://github.com/epiverse-trace/tutorials-late/edit/main/episodes/vaccine-comparisons.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 70 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What are the direct and indirect effects of vaccination?</li>
<li>What are the benefits of targeted vaccination programs?</li>
<li>What happens if we combine vaccination and NPIs?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Understand the potential impact of vaccination programs</li>
<li>Implement vaccination programs and NPI measures simultaneously using
<code>{epidemics}</code>
</li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="prereq1" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Prerequisite</h3>
<div class="callout-content">
<ul><li>Complete tutorials <a href="simulating-transmission.html">Simulating
transmission</a>, <a href="modelling-interventions.html">Modelling
interventions</a> and <a href="compare-interventions.html">Comparing
public health outcomes of interventions</a>.</li>
</ul><p>Learners should familiarise themselves with following concept
dependencies before working through this tutorial:</p>
<p><strong>Outbreak response</strong> : <a href="https://www.cdc.gov/nonpharmaceutical-interventions/" class="external-link">Intervention
types</a>.</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><p>Vaccine programs can be used to help control epidemics via direct and
indirect protection from infection. We can use mathematical models to
make predictions about the potential impact of different vaccination
strategies.</p>
<p>Depending on how infections spread, targeting specific risk groups
for vaccination may be a more effective strategy than vaccinating
everyone. When vaccine programs are not immediately available to be
rolled out, either from a capacity or development perspective, we may
also want to know how non-pharmaceutical interventions (NPIs) can be
used to control the epidemic in the mean time, as well as after a
vaccine program has started.</p>
<p>In this tutorial we will compare different vaccination strategies
using models from <code>{epidemics}</code>. We will use the following R
packages:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epidemics</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Instructor Note </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>Inline instructor notes can help inform instructors of timing
challenges associated with the lessons. They appear in the “Instructor
View”.</p>
<p>READ THESE LINES AND ERASE:</p>
<p>The Workbench-related sections that the developer must keep are:</p>
<ul><li>YAML on top</li>
<li>Questions</li>
<li>Objectives</li>
<li>Keypoints</li>
</ul><p>The Epiverse-TRACE sections that we encourage to keep are:</p>
<ul><li>Prerequisites</li>
<li>Introduction</li>
</ul><p>Take a look to the Contributing.md file for more writing
guidelines.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="direct-and-indirect-effects-of-vaccination">Direct and indirect effects of vaccination<a class="anchor" aria-label="anchor" href="#direct-and-indirect-effects-of-vaccination"></a></h2>
<hr class="half-width"><p>Vaccination programs using infection-blocking vaccines have two
benefits:</p>
<ol style="list-style-type: decimal"><li>Reducing individual risk of infection (<strong>direct</strong>
effect of vaccination)</li>
<li>Reducing onward contribution to transmission
(<strong>indirect</strong> effect of vaccination).</li>
</ol><p>We will illustrate this using results from
<code>model_default()</code> in <code>{epidemics}</code>. Using the
contact matrix and parameters from the COVID-19 outbreak example in <a href="modelling-interventions.html">Modelling interventions</a> we will
investigate the impact of two vaccination programs on the number of
infections. We will assume that vaccination programs start on day 0 and
continue to be in place for 150 days. We will assume all age groups are
vaccinated at the same rate in each program as follows :</p>
<ul><li>vaccination program 01 : vaccination rate 0.001</li>
<li>vaccination program 02 : vaccination rate 0.01.</li>
</ul><div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare vaccination objects</span></span>
<span><span class="va">vaccinate_01</span> <span class="op">&lt;-</span> <span class="fu">vaccination</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"vaccinate all"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">0</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">150</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.001</span>, <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vaccinate_02</span> <span class="op">&lt;-</span> <span class="fu">vaccination</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"vaccinate all"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">0</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">150</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>We see the intuitive result that the higher the vaccination rate, the
more people that are vaccinated.</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-1" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-1" type="button" role="tab" aria-controls="nav-tabpanel-1-1" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-1">
  Output
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-2" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-2" type="button" role="tab" aria-controls="nav-tabpanel-1-2" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-2">
  R Code
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-1" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-1-1">
<figure><img src="../fig/vaccine-comparisons-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
<div id="nav-tabpanel-1-2" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-2">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_baseline</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># rate</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># time</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">200</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_vaccinate_01</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># rate</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># intervention</span></span>
<span>  vaccination <span class="op">=</span> <span class="va">vaccinate_01</span>,</span>
<span>  <span class="co"># time</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">200</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_vaccinate_02</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># rate</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># intervention</span></span>
<span>  vaccination <span class="op">=</span> <span class="va">vaccinate_02</span>,</span>
<span>  <span class="co"># time</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">200</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create intervention_type column for plotting</span></span>
<span><span class="va">output_baseline</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"baseline"</span></span>
<span><span class="va">output_vaccinate_01</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"vaccinate 0.001"</span></span>
<span><span class="va">output_vaccinate_02</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"vaccinate 0.01"</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">output_baseline</span>, <span class="va">output_vaccinate_01</span>, <span class="va">output_vaccinate_02</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">output</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"vaccinated"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Number vaccinated"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span>,</span>
<span>    color <span class="op">=</span> <span class="va">intervention_type</span>,</span>
<span>    linetype <span class="op">=</span> <span class="va">intervention_type</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>      <span class="va">vaccinate_01</span><span class="op">$</span><span class="va">time_begin</span>,</span>
<span>      <span class="va">vaccinate_01</span><span class="op">$</span><span class="va">time_end</span></span>
<span>    <span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>To understand the <strong>indirect</strong> effect of vaccinations,
we want to know the effect that vaccination has on transmission, and
hence the rate at new infections occur. We will use the function
<code>new_infections()</code> in <code>{epidemics}</code> to calculate
the number of new infections over time for the different vaccination
programs.</p>
<p>The inputs required are :</p>
<ul><li>
<code>data</code> : the model output,</li>
<li>
<code>compartments_from_susceptible</code> : this is an optional
input, but in our case needed. We don’t want the number of people
vaccinated to be counted as new infections, so we need to specify the
name of the model compartment where individuals transition out from
<code>susceptible</code> (in this example <code>vaccinated</code>),</li>
<li>
<code>by_group</code> : should the results be calculated for each
demographic group separately.</li>
</ul><div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vaccinate_01_infections</span> <span class="op">&lt;-</span> <span class="fu">new_infections</span><span class="op">(</span><span class="va">output_vaccinate_01</span>,</span>
<span>                                          compartments_from_susceptible <span class="op">=</span></span>
<span>                                            <span class="st">"vaccinated"</span>,</span>
<span>                                          by_group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="tabs">
<nav><div id="nav-tab-2" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-2-1" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-1" type="button" role="tab" aria-controls="nav-tabpanel-2-1" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-2-1">
  Output
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-2" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-2" type="button" role="tab" aria-controls="nav-tabpanel-2-2" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-2">
  R code
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-2" class="tab-content">
<div id="nav-tabpanel-2-1" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-2-1">
<figure><img src="../fig/vaccine-comparisons-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
<div id="nav-tabpanel-2-2" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-2-2">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate new infections</span></span>
<span><span class="va">baseline_infections</span> <span class="op">&lt;-</span> <span class="fu">new_infections</span><span class="op">(</span><span class="va">output_baseline</span>,</span>
<span>                                      compartments_from_susceptible <span class="op">=</span></span>
<span>                                        <span class="st">"vaccinated"</span>,</span>
<span>                                      by_group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">vaccinate_01_infections</span> <span class="op">&lt;-</span> <span class="fu">new_infections</span><span class="op">(</span><span class="va">output_vaccinate_01</span>,</span>
<span>                                          compartments_from_susceptible <span class="op">=</span></span>
<span>                                            <span class="st">"vaccinated"</span>,</span>
<span>                                          by_group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">vaccinate_02_infections</span> <span class="op">&lt;-</span> <span class="fu">new_infections</span><span class="op">(</span><span class="va">output_vaccinate_02</span>,</span>
<span>                                          compartments_from_susceptible <span class="op">=</span></span>
<span>                                            <span class="st">"vaccinated"</span>,</span>
<span>                                          by_group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create intervention_type column for plotting</span></span>
<span><span class="va">baseline_infections</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"baseline"</span></span>
<span><span class="va">vaccinate_01_infections</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"vaccinate 0.001"</span></span>
<span><span class="va">vaccinate_02_infections</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"vaccinate 0.01"</span></span>
<span><span class="va">infections</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">baseline_infections</span>,</span>
<span>                    <span class="va">vaccinate_01_infections</span>,</span>
<span>                    <span class="va">vaccinate_02_infections</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">infections</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"New infections"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>            <span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">new_infections</span>, colour <span class="op">=</span> <span class="va">intervention_type</span>,</span>
<span>              linetype <span class="op">=</span> <span class="va">intervention_type</span></span>
<span>            <span class="op">)</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>      <span class="va">vaccinate_01</span><span class="op">$</span><span class="va">time_begin</span>,</span>
<span>      <span class="va">vaccinate_01</span><span class="op">$</span><span class="va">time_end</span></span>
<span>    <span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>We see that after accounting for the number of people vaccinated,
there are fewer new infections when you have a higher vaccination rate.
This is because there are fewer people susceptible to infection, and
therefore fewer people who can become infected and contribute to onward
infection.</p>
<p>This <strong>indirect</strong> effect of vaccination programs is key
to successfully controlling and eradicating infections.</p>
<p>To evaluate the impact of the vaccination programs, we are often
interested in both the peak size (i.e. healthcare pressure at single
point in time) as well as overall epidemic size (i.e. cumulative number
of infections).</p>
<p>We can find the cumulative sum using the R function
<code>cumsum()</code> and use <code>purr::map_dfr()</code> to loop over
a list of new infection data frames. We can see the difference in
infection numbers is by several orders of magnitude.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create function that returns the intervention type and cumulative sum for</span></span>
<span><span class="co"># given infections</span></span>
<span><span class="va">find_cumsum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">infections</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="fu">data.frame</span><span class="op">(</span>intervention_type <span class="op">=</span> <span class="fu">unique</span><span class="op">(</span><span class="va">infections</span><span class="op">$</span><span class="va">intervention_type</span><span class="op">)</span>,</span>
<span>                    cumulative_sum <span class="op">=</span> <span class="fu">tail</span><span class="op">(</span><span class="fu">cumsum</span><span class="op">(</span><span class="va">infections</span><span class="op">$</span><span class="va">new_infections</span><span class="op">)</span>,</span>
<span>                                          n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># create list of interventions</span></span>
<span><span class="va">interventions</span> <span class="op">&lt;-</span> <span class="fu">lst</span><span class="op">(</span><span class="va">baseline_infections</span>,</span>
<span>                     <span class="va">vaccinate_01_infections</span>,</span>
<span>                     <span class="va">vaccinate_02_infections</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># apply function to each data frame in the list</span></span>
<span><span class="fu">map_dfr</span><span class="op">(</span><span class="va">interventions</span>, <span class="va">find_cumsum</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  intervention_type cumulative_sum
1          baseline    53478985.93
2   vaccinate 0.001    44803253.91
3    vaccinate 0.01       34550.48</code></pre>
</div>
<div id="herd-immunity-threshold" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="herd-immunity-threshold" class="callout-inner">
<h3 class="callout-title">Herd immunity threshold</h3>
<div class="callout-content">
<p>There exists a target threshold of vaccination based on the basic
reproduction number <span class="math inline">\(R_0\)</span> to achieve
<a href="reference.html#herdimmunity">herd immunity</a> .</p>
<p>The proportion of the population (<span class="math inline">\(p\)</span>) that needs to be immune to achieve
herd immunity is:</p>
<p><span class="math display">\[p = 1- \frac{1}{R_0}. \]</span></p>
<p>For details of the mathematical derivation check out this <a href="https://plus.maths.org/content/maths-minute-r0-and-herd-immunity" class="external-link">Plus
Magazine article</a>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="targeted-vaccination">Targeted vaccination<a class="anchor" aria-label="anchor" href="#targeted-vaccination"></a></h2>
<hr class="half-width"><p>For infections that have a higher burden in different risk groups,
targeted vaccination programs can be utilised to control infection. For
example, if there is heterogeneity in contacts by age, targeting
different age groups for vaccination will result in different disease
trajectories.</p>
<p>We will use the same contact matrix as above from <a href="modelling-interventions.html">Modelling interventions</a> :</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contact_matrix</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                 age.group
contact.age.group    [0,15)  [15,65)       65+
          [0,15)  6.8461538 1.655174 0.5892799
          [15,65) 6.0737213 9.169207 4.1223575
          65+     0.5258855 1.002545 1.7142857</code></pre>
</div>
<p>There is higher levels of mixing within the 0-15 and 15-65 age group,
than in the 65+ age a group so we expect that targeting different age
groups will result in different disease trajectories.</p>
<p>To show the effect of targeted vaccination, we will compare the
following scenarios:</p>
<ul><li>vaccinating all age groups at a rate 0.001,</li>
<li>vaccinating ages 0-15 only (group 1) at a rate 0.003,</li>
<li>vaccinating ages 15-65 only (group 2) at a rate 0.003,</li>
<li>vaccinating ages 65+ only (group 3) at a rate 0.003.</li>
</ul><div class="tabs">
<nav><div id="nav-tab-3" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-3-1" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-3-1" type="button" role="tab" aria-controls="nav-tabpanel-3-1" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-3-1">
  Output
  </h3>
</button>
<button class="nav-link" id="nav-tab-3-2" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-3-2" type="button" role="tab" aria-controls="nav-tabpanel-3-2" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-3-2">
  R Code
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-3" class="tab-content">
<div id="nav-tabpanel-3-1" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-3-1">
<figure><img src="../fig/vaccine-comparisons-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
<div id="nav-tabpanel-3-2" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-3-2">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vaccinate_group_1</span> <span class="op">&lt;-</span> <span class="fu">vaccination</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"vaccinate all"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">40</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">40</span> <span class="op">+</span> <span class="fl">150</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.001</span> <span class="op">*</span> <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vaccinate_group_2</span> <span class="op">&lt;-</span> <span class="fu">vaccination</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"vaccinate all"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">40</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">40</span> <span class="op">+</span> <span class="fl">150</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.001</span> <span class="op">*</span> <span class="fl">3</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vaccinate_group_3</span> <span class="op">&lt;-</span> <span class="fu">vaccination</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"vaccinate all"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">40</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">40</span> <span class="op">+</span> <span class="fl">150</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.001</span> <span class="op">*</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_vaccinate_group_1</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># rate</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># intervention</span></span>
<span>  vaccination <span class="op">=</span> <span class="va">vaccinate_group_1</span>,</span>
<span>  <span class="co"># time</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">200</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_vaccinate_group_2</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># rate</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># intervention</span></span>
<span>  vaccination <span class="op">=</span> <span class="va">vaccinate_group_2</span>,</span>
<span>  <span class="co"># time</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">200</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">output_vaccinate_group_3</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  <span class="co"># population</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  <span class="co"># rate</span></span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  <span class="co"># intervention</span></span>
<span>  vaccination <span class="op">=</span> <span class="va">vaccinate_group_3</span>,</span>
<span>  <span class="co"># time</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">200</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vaccinate_group_1_infections</span> <span class="op">&lt;-</span> <span class="fu">new_infections</span><span class="op">(</span><span class="va">output_vaccinate_group_1</span>,</span>
<span>                                               compartments_from_susceptible <span class="op">=</span></span>
<span>                                                 <span class="st">"vaccinated"</span>, by_group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">vaccinate_group_2_infections</span> <span class="op">&lt;-</span> <span class="fu">new_infections</span><span class="op">(</span><span class="va">output_vaccinate_group_2</span>,</span>
<span>                                               compartments_from_susceptible <span class="op">=</span></span>
<span>                                                 <span class="st">"vaccinated"</span>, by_group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">vaccinate_group_3_infections</span> <span class="op">&lt;-</span> <span class="fu">new_infections</span><span class="op">(</span><span class="va">output_vaccinate_group_3</span>,</span>
<span>                                               compartments_from_susceptible <span class="op">=</span></span>
<span>                                                 <span class="st">"vaccinated"</span>, by_group <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vaccinate_group_1_infections</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"vaccinate group 1"</span></span>
<span><span class="va">vaccinate_group_2_infections</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"vaccinate group 2"</span></span>
<span><span class="va">vaccinate_group_3_infections</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"vaccinate group 3"</span></span>
<span></span>
<span><span class="va">output_infections</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">baseline_infections</span>,</span>
<span>                           <span class="va">vaccinate_01_infections</span>,</span>
<span>                           <span class="va">vaccinate_group_1_infections</span>,</span>
<span>                           <span class="va">vaccinate_group_2_infections</span>,</span>
<span>                           <span class="va">vaccinate_group_3_infections</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">output_infections</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>            <span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">new_infections</span>, colour <span class="op">=</span> <span class="va">intervention_type</span>,</span>
<span>              linetype <span class="op">=</span> <span class="va">intervention_type</span></span>
<span>            <span class="op">)</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>      <span class="va">vaccinate_01</span><span class="op">$</span><span class="va">time_begin</span>,</span>
<span>      <span class="va">vaccinate_01</span><span class="op">$</span><span class="va">time_end</span></span>
<span>    <span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>Vaccinating group 3 only results in the highest epidemic peak size.
Targeting group 2 results in the smallest epidemic peak size. Whereas
targeting all age groups pushes the epidemic peak time later. As before,
let’s compare the cumulative number of infections under the different
interventions:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interventions_targetted</span> <span class="op">&lt;-</span> <span class="fu">lst</span><span class="op">(</span><span class="va">baseline_infections</span>,</span>
<span>                               <span class="va">vaccinate_01_infections</span>,</span>
<span>                               <span class="va">vaccinate_group_1_infections</span>,</span>
<span>                               <span class="va">vaccinate_group_2_infections</span>,</span>
<span>                               <span class="va">vaccinate_group_3_infections</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># apply function to each data frame in the list</span></span>
<span><span class="fu">map_dfr</span><span class="op">(</span><span class="va">interventions_targetted</span>, <span class="va">find_cumsum</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  intervention_type cumulative_sum
1          baseline       53478986
2   vaccinate 0.001       44803254
3 vaccinate group 1       50429226
4 vaccinate group 2       42035053
5 vaccinate group 3       51634221</code></pre>
</div>
<div class="section level3">
<h3 id="age-specific-infection-fatality-risk">Age specific infection-fatality-risk<a class="anchor" aria-label="anchor" href="#age-specific-infection-fatality-risk"></a></h3>
<p>Targeting specific age groups can reduce the impact of infections
that have age specific risk of mortality. To illustrate this, we can
define an age specific infection-fatality-risk (IFR) :</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ifr</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.00001</span>, <span class="fl">0.001</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">ifr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">rownames</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span></code></pre>
</div>
<p>To convert infections to deaths, we will need new infections by age
group, so we call <code>new_infections()</code> with
<code>by_group = TRUE</code> and then multiple the new infections by the
IFR for that age group:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vaccinate_group_1_age</span> <span class="op">&lt;-</span> <span class="fu">new_infections</span><span class="op">(</span><span class="va">output_vaccinate_group_1</span>,</span>
<span>                                        compartments_from_susceptible <span class="op">=</span></span>
<span>                                          <span class="st">"vaccinated"</span>, by_group <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vaccinate_group_1_deaths</span> <span class="op">&lt;-</span></span>
<span>  <span class="fl">1</span><span class="op">:</span><span class="fl">3</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">map_dfr</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">vaccinate_group_1_age</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu">filter</span><span class="op">(</span><span class="va">demography_group</span> <span class="op">==</span> <span class="fu">names</span><span class="op">(</span><span class="va">ifr</span><span class="op">)</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu">mutate</span><span class="op">(</span>deaths <span class="op">=</span> <span class="va">new_infections</span> <span class="op">*</span> <span class="va">ifr</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Vaccinating all age groups has the greatest impact on deaths in the
eldest age group (over 65 years of age), but we also see that
vaccinating group 2 reduces the deaths in the eldest age group.
Targeting younger groups can the number of deaths in the eldest age
group (over 65 years of age).</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseline_deaths</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"baseline"</span></span>
<span><span class="va">vaccinate_01_deaths</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"vaccinate 0.001"</span></span>
<span><span class="va">vaccinate_group_1_deaths</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"vaccinate group 1"</span></span>
<span><span class="va">vaccinate_group_2_deaths</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"vaccinate group 2"</span></span>
<span><span class="va">vaccinate_group_3_deaths</span><span class="op">$</span><span class="va">intervention_type</span>  <span class="op">&lt;-</span> <span class="st">"vaccinate group 3"</span></span>
<span></span>
<span><span class="va">output_deaths</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">baseline_deaths</span>,</span>
<span>                       <span class="va">vaccinate_01_deaths</span>,</span>
<span>                       <span class="va">vaccinate_group_1_deaths</span>,</span>
<span>                       <span class="va">vaccinate_group_2_deaths</span>,</span>
<span>                       <span class="va">vaccinate_group_3_deaths</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_deaths</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">demography_group</span> <span class="op">==</span> <span class="st">"65+"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Deaths"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>            <span class="fu">aes</span><span class="op">(</span><span class="va">time</span>,</span>
<span>              <span class="va">deaths</span>,</span>
<span>              colour <span class="op">=</span> <span class="va">intervention_type</span>,</span>
<span>              linetype <span class="op">=</span> <span class="va">demography_group</span></span>
<span>            <span class="op">)</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/vaccine-comparisons-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</section><section><h2 class="section-heading" id="vaccination-versus-npis">Vaccination versus NPIs<a class="anchor" aria-label="anchor" href="#vaccination-versus-npis"></a></h2>
<hr class="half-width"><p>Modelling is a useful tool for understanding the potential impact of
the timing and different combinations of control measures. In an
outbreak scenario, vaccines can be used alongside other control
measures. A recent study by <a href="https://doi.org/10.1016/S2214-109X(24)00286-9" class="external-link">Barnsley et
al. (2024)</a> used modelling to show the impact the COVID-19 vaccine
could have had alongside NPIs if the vaccine had been developed within
100 days of the pathogen threat being recognised. We will use this study
as inspiration to show the impact of a vaccine versus NPI implemented at
different times.</p>
<p>The NPI we will consider is temporarily closing schools, an
intervention that has been used as a control measure for seasonal
influenza <a href="https://doi.org/10.3201/eid1410.080646" class="external-link">(Cowling et
al. 2008)</a>. Specifically, we will model a school closure that will
reduce the contacts between school aged children (aged 0-15) by 0.5, and
will cause a small reduction (0.01) in the contacts between adults (aged
15 and over). For the vaccine program, we assume an equal vaccination
rate of 0.01 in each age group.</p>
<p>We define <strong>early implementation</strong> as the first day of
the simulation (i.e. when there are less than 100 infections in total),
and <strong>late implementation</strong> as 50 days after the start of
the simulation (i.e. when there are approximately 50,000 infections in
total). We assume the control measures are in place for 100 days after
they start.</p>
<p>The combinations we will consider are :</p>
<ul><li>early implementation of closing schools,</li>
<li>early implementation of a vaccine,</li>
<li>late implementation of a vaccine,</li>
<li>early implementation of closing schools and late implementation of a
vaccine.</li>
</ul><p>The code below details how the interventions are simulated:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">early_start</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">late_start</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">duration</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">time_end</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># close schools early</span></span>
<span><span class="va">close_schools_early</span> <span class="op">&lt;-</span> <span class="fu">intervention</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"School closure"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"contacts"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="va">early_start</span>,</span>
<span>  time_end <span class="op">=</span> <span class="va">early_start</span> <span class="op">+</span> <span class="va">duration</span>,</span>
<span>  reduction <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vaccination late</span></span>
<span><span class="va">vacc_late</span> <span class="op">&lt;-</span> <span class="fu">vaccination</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"vaccinate late"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="va">late_start</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="va">late_start</span> <span class="op">+</span> <span class="va">duration</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># npis started early + vaccination late</span></span>
<span><span class="va">output_npi_early_vacc_late</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  vaccination <span class="op">=</span> <span class="va">vacc_late</span>,</span>
<span>  intervention <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>contacts <span class="op">=</span> <span class="va">close_schools_early</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="va">time_end</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Early implementation of NPIs (<code>early npi</code>) delays the
timing of the peak of infectious individuals but does not decrease the
magnitude by much once the measure is lifted. Early implementation of
the vaccine (<code>early vacc</code>) is the most effective control for
reducing the peak number of infectious individuals, because it reduces
the size of the susceptible group rather than just temporarily keeping
infections away from it. Having an NPI in place before the vaccine is
implemented (<code>early npi, late vacc</code>) is more effective than
simply just implementing the vaccine late (<code>late vacc</code>).</p>
<figure><img src="../fig/vaccine-comparisons-rendered-unnamed-chunk-20-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="lifting-npi-measures" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="lifting-npi-measures" class="callout-inner">
<h3 class="callout-title">Lifting NPI measures</h3>
<div class="callout-content">
<p>Investigate the impact lifting the after implementing the vaccine.
Adapt the code below to lift the NPI after 20, 50 and 100 days</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Output </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">duration_20</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">duration_50</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="va">close_schools_early_20</span> <span class="op">&lt;-</span> <span class="fu">intervention</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"School closure"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"contacts"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="va">early_start</span>,</span>
<span>  time_end <span class="op">=</span> <span class="va">early_start</span> <span class="op">+</span> <span class="va">duration_20</span>,</span>
<span>  reduction <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">close_schools_early_50</span> <span class="op">&lt;-</span> <span class="fu">intervention</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"School closure"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"contacts"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="va">early_start</span>,</span>
<span>  time_end <span class="op">=</span> <span class="va">early_start</span> <span class="op">+</span> <span class="va">duration_50</span>,</span>
<span>  reduction <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_npi_early_vacc_late_20</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  vaccination <span class="op">=</span> <span class="va">vacc_late</span>,</span>
<span>  intervention <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>contacts <span class="op">=</span> <span class="va">close_schools_early_20</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">300</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_npi_early_vacc_late_50</span> <span class="op">&lt;-</span> <span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">uk_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="va">transmission_rate</span>,</span>
<span>  infectiousness_rate <span class="op">=</span> <span class="va">infectiousness_rate</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="va">recovery_rate</span>,</span>
<span>  vaccination <span class="op">=</span> <span class="va">vacc_late</span>,</span>
<span>  intervention <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>contacts <span class="op">=</span> <span class="va">close_schools_early_50</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">300</span>, increment <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_npi_early_vacc_late_20</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"20 days"</span></span>
<span><span class="va">output_npi_early_vacc_late_50</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"50 days"</span></span>
<span><span class="va">output_npi_early_vacc_late</span><span class="op">$</span><span class="va">intervention_type</span> <span class="op">&lt;-</span> <span class="st">"100 days"</span></span>
<span></span>
<span><span class="va">output_npis</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="va">output_npi_early_vacc_late_20</span>,</span>
<span>                     <span class="va">output_npi_early_vacc_late_50</span>,</span>
<span>                     <span class="va">output_npi_early_vacc_late</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_npis</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"infectious"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span>,</span>
<span>    color <span class="op">=</span> <span class="va">intervention_type</span>,</span>
<span>    linetype <span class="op">=</span> <span class="va">intervention_type</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>      <span class="va">early_start</span>,</span>
<span>      <span class="va">early_start</span> <span class="op">+</span> <span class="va">duration</span></span>
<span>    <span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>      <span class="va">late_start</span>,</span>
<span>      <span class="va">late_start</span> <span class="op">+</span> <span class="va">duration</span></span>
<span>    <span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/vaccine-comparisons-rendered-unnamed-chunk-21-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a></h2>
<hr class="half-width"><p>Using model generated disease trajectories we have investigated the
potential impact of different vaccination strategies. When infection has
group specific risk, targeted vaccination programs may be more effective
in reducing epidemic peak. NPIs can be used alongside vaccine
development to delay epidemic peaks before vaccines are readily
available.</p>
<p>We used a SEIR model with a vaccination class, but if we modelled
immunity to infection then we could investigate the impact of a
vaccination program if it was implemented very late in the epidemic
(i.e. after post-infection immunity had accumulated). See for example,
<a href="https://doi.org/10.1016/j.vaccine.2010.01.002" class="external-link">Baguelin et
al. 2010</a></p>
<p>In this tutorial we have investigated the potential effect of
infection blocking vaccines, but we can use models to explore other
effects of vaccines including imperfect vaccines. The disease
trajectories generated in this tutorial can be used to calculate
measures such as <a href="reference.html#dalys">DALYs</a> averted as
part of health economic analyses.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Herd immunity is a indirect effect of vaccination programs</li>
<li>Targeted vaccination programs have benefits when there is
heterogeneity in contacts</li>
<li>The timing of implementation of vaccination programs and NPIs can
result in very different disease trajectories</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/compare-interventions.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/disease-burden.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/compare-interventions.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Comparing public
        </a>
        <a class="chapter-link float-end" href="../instructor/disease-burden.html" rel="next">
          Next: Modelling disease...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/tutorials-late/edit/main/episodes/vaccine-comparisons.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/tutorials-late/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace/tutorials-late/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials-late/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/bad0be19a12f0c6545801b276ddf26c945f8bfd1" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/tutorials-late/instructor/vaccine-comparisons.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "epidemic models, interventions",
  "name": "Comparing vaccination strategies",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials-late/instructor/vaccine-comparisons.html",
  "identifier": "https://epiverse-trace.github.io/tutorials-late/instructor/vaccine-comparisons.html",
  "dateCreated": "2025-02-04",
  "dateModified": "2025-02-04",
  "datePublished": "2025-02-04"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

