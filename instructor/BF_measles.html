<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Scenario modelling for outbreak analytics with R: Introduction to Mathematical Modelling of Infectious Diseases</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/epiverse-trace/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/epiverse-trace/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/epiverse-trace/favicon-16x16.png"><link rel="manifest" href="../favicons/epiverse-trace/site.webmanifest"><link rel="mask-icon" href="../favicons/epiverse-trace/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epiverse-trace"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epiverse-trace-logo" alt="epiverse-trace" src="../assets/images/epiverse-trace-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../BF_measles.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epiverse-trace" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epiverse-trace" src="../assets/images/epiverse-trace-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Scenario modelling for outbreak analytics with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Scenario modelling for outbreak analytics with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="BF_measles.html">Introduction to Mathematical Modelling of Infectious Diseases</a></li><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Scenario modelling for outbreak analytics with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: NA%" class="percentage">
    NA%
  </div>
  <div class="progress epiverse-trace">
    <div class="progress-bar epiverse-trace" role="progressbar" style="width: NA%" aria-valuenow="NA" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../BF_measles.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="contact-matrices.html">1. Contact matrices</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="simulating-transmission.html">2. Simulating transmission</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="model-choices.html">3. Choosing an appropriate model</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="modelling-interventions.html">4. Modelling interventions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="compare-interventions.html">5. Comparing public health outcomes of interventions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="vaccine-comparisons.html">6. Comparing vaccination strategies</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="disease-burden.html">7. Modelling disease burden</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="BF_measles.html">Introduction to Mathematical Modelling of Infectious Diseases</a></li><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Introduction to Mathematical Modelling of Infectious Diseases</h1>
        <p>Last updated on 2025-04-15 |

        <a href="https://github.com/epiverse-trace/tutorials-late/edit/main/learners/BF_measles.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>





        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="section level1">
<h1 id="preface">Preface<a class="anchor" aria-label="anchor" href="#preface"></a></h1>
<p>This document is prepared for the participants of the Outbreak
Analytics in R course, organized by the Epiverse-TRACE team. Its purpose
is to provide a concise introduction to the mathematical theory behind
modeling infectious epidemics. We will use the Susceptible, Exposed,
Infected, and Recovered (<strong>SEIR</strong>) model, applicable to
diseases like measles, mumps, rubella, as an example.</p>
</div>
<div class="section level1">
<h1 id="scenario">Scenario<a class="anchor" aria-label="anchor" href="#scenario"></a></h1>
<p>Suppose a new infection has been detected in a closed community of
<span class="math inline">\(\mathbf{N}\)</span> individuals, with the
infection diagnosed in a single individual. The remaining <span class="math inline">\(\mathbf{N-1}\)</span> individuals are all at risk
of getting the infection and are considered susceptible (<span class="math inline">\(\mathbf{S}\)</span>). An infected person makes
<span class="math inline">\(k\)</span> contacts and have a probability
<span class="math inline">\(p\)</span> of infecting each one if
susceptible, and we can call this <span class="math inline">\(\beta\)</span> for short. This represents the
average rate at which an infected individual can transmit the infection
to a susceptible individual.</p>
<p>Depending on the nature of the disease, a newly infected individual
may take time to show symptoms, known as the incubation period (time
from infection to symptoms), and time to become infectious, known as the
latent period (time from infection to infectiousness). The latent period
is relevant to the SEIR-type models. Susceptible individuals who come
into contact with an infected person and acquire the infection first
move to an intermediate state called exposed (<span class="math inline">\(\mathbf{E}\)</span>). There they spend, on
average, <span class="math inline">\(\frac{1}{\alpha}\)</span> units of
time (the latent period) and then move to the infected class (<span class="math inline">\(\mathbf{I}\)</span>) at a constant rate <span class="math inline">\(\alpha\)</span>. Infected individuals are removed
(either by recovery or death) from <span class="math inline">\(I\)</span> at a constant rate <span class="math inline">\(\gamma\)</span>, with <span class="math inline">\(\frac{1}{\gamma}\)</span> representing the average
recovery duration. Upon recovery, they gain lifelong immunity against
the current infection, meaning they do not become susceptible again, and
they move to the recovered class (<span class="math inline">\(\mathbf{R}\)</span>) (see <a href="#fig-seir">Figure 1</a>). These are some assumptions for modelling
purposes and may not particularly reflect the biological underlying
processes.</p>
<p><img src="../fig/t0.drawio.png" ref-parent="fig-seir" class="figure"><img src="../fig/t1.drawio.png" ref-parent="fig-seir" class="figure"><img src="../fig/t2.drawio.png" ref-parent="fig-seir" class="figure"><img src="../fig/t3.drawio.png" ref-parent="fig-seir" class="figure"></p>
<p>The four S-E-I-R classes considered in the <span class="math inline">\(\mathbf{SEIR}\)</span> model. The number of
individuals in each change overtime and thus are functions of time <span class="math inline">\(t\)</span>, and the total population at any time
<span class="math inline">\(t\)</span> is <span class="math inline">\(N(t)=  S(t) + E(t) + I(t)+ R(t)\)</span>. The
rates of change between these classes are captured mathematically
through four differential equations as follows:</p>
<p><span id="eq-s1"><span class="math display">\[
\begin{eqnarray}
\frac{dS}{dt} &amp;=&amp; -\beta \frac{S.I}{N} &amp; &amp; \\
\frac{dE}{dt} &amp;=&amp;\beta \frac{S.I}{N} &amp;-&amp; \alpha E\\
\frac{dI}{dt} &amp;=&amp; \alpha E &amp;-&amp; \gamma I \\
\frac{dR}{dt} &amp;=&amp; \gamma I  &amp; &amp;\\
\end{eqnarray}
\qquad(1)\]</span></span></p>
<p>At time <span class="math inline">\(t_0=0\)</span>, we assume there
is one infected person (<span class="math inline">\(\mathbf{I}_0
=1\)</span>); no exposed (<span class="math inline">\(\mathbf{E}_0 =
0\)</span>) or recovery (<span class="math inline">\(\mathbf{R}_0 =
0\)</span>). and while all other individuals remain susceptible (<span class="math inline">\(\mathbf{S}_0= \mathbf{N} -\mathbf{I}_0 =
\mathbf{N} -1\)</span>). These are known as the initial values of the
system in <a href="#eq-s1">Equation 1</a>.</p>
<p>Since the compartments represent individuals, their values must
always be non-negative. This characteristic is referred to as the
positivity of the solution. Before delving into mathematical details of
how to solve <a href="#eq-s1">Equation 1</a>, a few key observations can
be made:</p>
<ol style="list-style-type: decimal"><li><p>At the onset of an epidemic, the number of susceptible
individuals begins to decrease exponentially, while the number of
exposed and infectious individuals increases. As the epidemic
progresses, the susceptible population becomes depleted, and the exposed
and infectious groups reach their peak before starting to decline.
Meanwhile, the number of recovered individuals continues to increase
without decreasing. (Note that these observations hold true only when
<span class="math inline">\(\mathcal{R}_0 &gt; 1\)</span>, as we shall
see later in this document).</p></li>
<li><p>The infection will start spreading in the community only when
<span class="math inline">\(\frac{\mathbf{dE}}{dt} &gt; 0\)</span> or
<span class="math inline">\(\frac{\mathbf{dI}}{dt} &gt; 0\)</span>, and
taking the values of these two terms from <a href="#eq-s1">Equation
1</a> leads to</p></li>
</ol><p><span id="eq-s2"><span class="math display">\[
\begin{eqnarray}
\beta .\frac{S.I}{N} &amp;-&amp; \alpha .E &gt; 0\\
\alpha. E &amp;-&amp; \gamma .I &gt; 0.
\end{eqnarray}
\qquad(2)\]</span></span> Adding the two equations in <a href="#eq-s2">Equation 2</a>, gives <span class="math inline">\(\frac{\beta}{\gamma} &gt;
\frac{\mathbf{N}}{\mathbf{S}}\)</span>. At time <span class="math inline">\(t=0\)</span>, we have <span class="math inline">\(\mathbf{S} = \mathbf{N}-1
\approx  \mathbf{N}\)</span>. Therefore, the infection will take off if
<span class="math inline">\(\frac{\beta}{\gamma} &gt; 1\)</span>. This
is a very interesting observation – It tells that the epidemic increases
if new infections are generated at a higher rate than existing
infections recover.</p>
<ol start="3" style="list-style-type: decimal"><li><p>The ratio <span class="math inline">\(\frac{\beta}{\gamma}\)</span> represents the basic
reproduction number, <span class="math inline">\(\mathcal{R}_0\)</span>,
which is defined as the average number of new infections caused by a
single infected individual in a fully susceptible population.
Intuitively, <span class="math inline">\(\beta\)</span> alone only
describes the rate of new infections, without considering how long each
infected individual contributes to transmission. By accounting for the
infectious period <span class="math inline">\(\frac{1}{\gamma}\)</span>,
we obtain a complete measure of each infected individual’s impact on
transmission over their entire infectious duration. <span class="math inline">\(\mathcal{R}_0\)</span> is a crucial metric for
understanding the transmissibility of an infectious disease. A higher
value of <span class="math inline">\(\mathcal{R}_0\)</span> indicates a
more transmissible disease.</p></li>
<li><p>The final size of an epidemic—the total number of individuals who
will ultimately be infected—is the cumulative count of infections as
predicted by the model. However, If only the <span class="math inline">\(\mathcal{R}_0\)</span> is known, it can still
provide insights into the outbreak’s final size through the following
equation: <span id="eq-fs"><span class="math display">\[
\begin{equation}
z = 1 - e^{-\mathcal{R}_0 .z}
\end{equation}
\qquad(3)\]</span></span></p></li>
</ol><p>Where:</p>
<ul><li><p><span class="math inline">\(z\)</span> is the final size (the
fraction of the population infected),</p></li>
<li><p><span class="math inline">\(\mathcal{R}_0\)</span> is the basic
reproduction number, and</p></li>
<li><p><span class="math inline">\(e\)</span> is the base of the natural
logarithm.</p></li>
</ul><p>For a detailed derivation and theoretical background on the final
size equation, please refer to <a href="https://epiverse-trace.github.io/finalsize/articles/theoretical_background.html" class="external-link">this
article</a>.</p>
<ol start="5" style="list-style-type: decimal"><li>Additionally, the basic reproduction number <span class="math inline">\(\mathcal{R}_0\)</span> is crucial for determining
the herd immunity threshold (HIT), which represents the minimum
proportion of the population that must be immune (either through
vaccination or previous infection) in order to contain the epidemic and
prevent widespread transmission. The formula for the herd immunity
threshold is: <span id="eq-hit"><span class="math display">\[ HIT = 1 -
\frac{1}{\mathcal{R}_0} \qquad(4)\]</span></span>
</li>
</ol><p>Where:</p>
<ul><li>HIT is the proportion of the population that needs to be immune to
achieve herd immunity,</li>
</ul><p>As <span class="math inline">\(\mathcal{R}_0\)</span> increases, the
herd immunity threshold also increases, meaning a larger proportion of
the population must be immune to prevent the epidemic from
spreading.</p>
<p>To understand the logic behind the HIT formula, note that as time
passes, immunity builds up in the population. This reduces the number of
susceptible individuals, thereby decreasing the actual number of
secondary cases that a typical infected person can produce. This number
is called the effective reproduction number (<span class="math inline">\(\mathcal{R}_{eff}\)</span>), and it is given as:
<span class="math display">\[ \mathcal{R}_{eff} = \mathcal{R}_0 \times
\mathbf{S}.\]</span></p>
<p>For an epidemic to stop spreading, each infected person must, on
average, infect fewer than one other person—meaning we need <span class="math inline">\(\mathcal{R}&lt;1\)</span>. This condition leads
to: <span class="math display">\[\mathbf{S} &lt;
\frac{1}{\mathcal{R}_0}\]</span></p>
<p>Thus, if we can reduce the susceptible proportion <span class="math inline">\(\mathbf{S}\)</span> below <span class="math inline">\(\frac{1}{\mathcal{R}_0}\)</span> the effective
reproduction number <span class="math inline">\(\mathcal{R}_{eff}\)</span> will drop below 1,
causing the epidemic to stop growing on average.</p>
</div>
<div class="section level1">
<h1 id="measles-outbreak-in-burkina-faso">Measles Outbreak in Burkina Faso<a class="anchor" aria-label="anchor" href="#measles-outbreak-in-burkina-faso"></a></h1>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a></h2>
<p>Measles is a highly contagious viral disease that spreads quickly,
particularly in environments where people live or gather in close
quarters, such as schools, healthcare facilities, or densely populated
urban areas. Transmission occurs through respiratory droplets when an
infected person coughs or sneezes, and the virus can remain viable in
the air for up to two hours. Effective vaccines are available, offering
an efficacy of 93% to 97% (<a href="https://www.cdc.gov/measles/about/index.html" class="external-link">About Measles,
CDC</a>), making vaccination a key tool in controlling measles
outbreaks.</p>
<p>Given the virus’s high transmissibility, even a single introduced
case of measles can trigger large outbreaks, especially in regions with
low vaccination coverage. The latent (pre-infectious) period for measles
is typically around 8 days, while the infectious period averages 5 days
(<a href="https://www.thelancet.com/journals/lanpub/article/PIIS2468-2667(23)00130-5/fulltext" class="external-link">Masters
et al., 2023</a>). The SEIR model in <a href="#eq-s1">Equation 1</a> can
e employed to simulate the dynamics of measles outbreaks and evaluate
control measures like vaccination.</p>
</div>
<div class="section level2">
<h2 id="burkina-faso-situation-in-jan-2024">Burkina Faso Situation in Jan 2024<a class="anchor" aria-label="anchor" href="#burkina-faso-situation-in-jan-2024"></a></h2>
<p>Burkina Faso faces recurring measles outbreaks. This can be
attributed to factors such as limited healthcare access, inadequate
vaccination coverage, and fragile healthcare systems. In 2023, Burkina
Faso experienced a particularly severe outbreak, with over 2,000
suspected cases reported (<a href="https://crisis24.garda.com/alerts/2024/02/burkina-faso-elevated-measles-activity-reported-in-multiple-areas-in-february" class="external-link">Crisis24,
2024</a>), prompting health authorities and international organizations
to scale up vaccination campaigns in an effort to curtail the spread of
the disease (<a href="https://www.savethechildren.net/news/burkina-faso-over-2000-children-diagnosed-suspected-measles-nationwide-outbreak" class="external-link">Save
the Children, 2024</a>; <a href="https://www.thecable.ng/burkina-faso-records-2000-suspected-cases-as-country-battles-measles-outbreak/" class="external-link">The
Cable, 2024</a>).</p>
<p>We will simulate the measles outbreak in Burkina Faso using the SEIR
model in <a href="#eq-s1">Equation 1</a>. This will allow us to explore
the outbreak dynamics with and without interventions. For this purpose,
we will use the <strong>R</strong> package <code>{epidemics}</code>,
which is designed for modeling infectious disease spread. In these
simulations, we will focus specifically on the number of infections,
which represents a subset of the total reported suspected cases.</p>
</div>
<div class="section level2">
<h2 id="baseline-model">Baseline Model<a class="anchor" aria-label="anchor" href="#baseline-model"></a></h2>
<p><strong>Model Assumptions and Parameters</strong></p>
<ol style="list-style-type: decimal"><li><p><strong>Total Population</strong>: The population of Burkina Faso
is approximately <span class="math inline">\(N\approx 22.67\)</span>
million.</p></li>
<li>
<p><strong>Population Structure</strong>:</p>
<ul><li>
<strong>No Age Stratification</strong>: Assume the population is
homogeneous with respect to age. This means that all individuals,
regardless of age, have the same susceptibility to measles and
contribute equally to the transmission dynamics.</li>
</ul></li>
<li>
<p><strong>Initial Conditions</strong>:</p>
<ul><li>A single infectious case is introduced into the population: <span class="math inline">\(I_0 = 1\)</span>.</li>
<li>The entire population, except for this one case, is initially
susceptible: <span class="math inline">\(S_0 = N - 1\)</span>. This
assumption simplifies the model and allows us to explore the spread of
infection in the absence of immunity. Although real populations
typically have some immunity due to vaccination or prior infection.</li>
<li>No individuals are in the exposed stage at the start: <span class="math inline">\(E_0 = 0\)</span>.</li>
<li>No individuals have recovered: <span class="math inline">\(R_0 =
0\)</span>.</li>
</ul></li>
<li><p><strong>latent Period</strong>: The average latent period for
measles is around 8 days (the time period between exposure and becoming
infectious), so the transition rate from exposed to infectious
individuals is: <span class="math inline">\(\alpha =
\frac{1}{8}\)</span>.</p></li>
<li><p><strong>Infectious Period</strong>: The average infectious period
lasts for 5 days, which means the recovery rate is: <span class="math inline">\(\gamma = \frac{1}{5}\)</span>.</p></li>
<li>
<p><strong>Basic Reproduction Number</strong> <span class="math inline">\(\mathcal{R}_0\)</span>:</p>
<ul><li>
<span class="math inline">\(\mathcal{R}_0 =15\)</span>. For measles
this value typically ranges from 12 to 18, or even more <a href="https://www.thelancet.com/journals/laninf/article/PIIS1473-3099(17)30307-9/abstract" class="external-link">Fiona,
et al</a>.</li>
<li>This makes the transmission rate <span class="math inline">\(\beta =
\mathcal{R}_0 \gamma = 3\)</span>–meaning each infectious individual
causes 3 new infections per day in a fully susceptible population.</li>
</ul></li>
</ol><p>By applying these assumptions and parameters to <a href="#eq-s1">Equation 1</a>, we can simulate the potential trajectory
of the measles outbreak using the syntax provided by the {epidemics}
package as shown in the below is code chunk.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading libraries</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epidemics</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the population structure for Burkina Faso</span></span>
<span><span class="va">bfaso</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">population</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Burkina Faso"</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># Well-mixed population</span></span>
<span>  demography_vector <span class="op">=</span> <span class="fl">22.67e6</span>, <span class="co"># Population size</span></span>
<span>  <span class="co"># Initial conditions: Susceptible, exposed, Infectious, vaccinated, recovered</span></span>
<span>  initial_conditions <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>    <span class="fu">c</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">22.67e6</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">22.67e6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the SEIR model simulation</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">bfaso</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="fl">15</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># R0/infectious period = 15/5 = 3</span></span>
<span>  infectiousness_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">8</span>, <span class="co"># 1/latent period (pre-infectious phase)</span></span>
<span>  recovery_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># 1/infectious period</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">120</span>, <span class="co"># Simulation over 120 days</span></span>
<span>  increment <span class="op">=</span> <span class="fl">1</span> <span class="co"># Daily increments</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the epidemic curve for susceptible, exposed, infectious, and recovered</span></span>
<span><span class="va">output</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"exposed"</span>, <span class="st">"infectious"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">6</span>, <span class="co"># Scale to millions</span></span>
<span>    col <span class="op">=</span> <span class="va">compartment</span>,</span>
<span>    linetype <span class="op">=</span> <span class="va">compartment</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals (in millions)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="fu">expression</span><span class="op">(</span></span>
<span>      <span class="fu">paste</span><span class="op">(</span></span>
<span>        <span class="st">"The dynamics of SEIR model with "</span>,</span>
<span>        <span class="fu">italic</span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span>, <span class="st">"= 15, "</span>,</span>
<span>        <span class="st">"showing the trajectories of number of exposed and infected individuals"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/BF_measles-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
<div class="section level2">
<h2 id="expected-epidemic-size-herd-immunity">Expected Epidemic Size &amp; Herd Immunity<a class="anchor" aria-label="anchor" href="#expected-epidemic-size-herd-immunity"></a></h2>
<p>The <a href="https://github.com/epiverse-trace/finalsize" class="external-link">finalsize</a> package implements <a href="#eq-fs">Equation 3</a> for calculate the expected proportion of
the population that will be infected given a specified basic
reproduction number <span class="math inline">\((\mathcal{R}_0)\)</span>. The calculation can be
done as follows:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">finalsize</span><span class="fu">::</span><span class="fu">final_size</span><span class="op">(</span>r0 <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    demo_grp   susc_grp susceptibility p_infected
1 demo_grp_1 susc_grp_1              1  0.9999546</code></pre>
</div>
<p>For <span class="math inline">\(\mathcal{R}_0 \geq 10\)</span>, the
results indicate that nearly the entire population is expected to be
infected by measles. The <span class="math inline">\(HIT\)</span> needed
to contains the epidemic is about <span class="math inline">\(93\%\)</span>, using the formula given in <a href="#eq-hit">Equation 4</a>.</p>
</div>
</div>
<div class="section level1">
<h1 id="age-structured-model">Age-Structured Model<a class="anchor" aria-label="anchor" href="#age-structured-model"></a></h1>
<p>The age structure of Burkina Faso is characteristic of a young
population, with a majority of the population being under 25 years old.
According to recent estimates (<a href="https://population.un.org/wpp/" class="external-link">United Nations, 2023</a>; <a href="https://www.cia.gov/the-world-factbook/countries/burkina-faso/" class="external-link">Central
Intelligence Agency, 2023</a>; <a href="https://data.worldbank.org/indicator/SP.POP.TOTL?locations=BF" class="external-link">World
Bank, 2023</a>), the age structure is broken down as follows:</p>
<ul><li>
<span class="math inline">\([0\to15)\)</span> years: ~ 44 (43-45)%
of the population</li>
<li>
<span class="math inline">\([15\to 25)\)</span> years: ~19.5
(19-20)%</li>
<li>
<span class="math inline">\([25\to 55)\)</span> years: ~29
(28-30)%</li>
<li>
<span class="math inline">\([55\to 65)\)</span> years: ~5
(3-5)%</li>
<li>
<span class="math inline">\(65+\)</span> years : ~2.5 (2-3)%</li>
</ul><div class="section level2">
<h2 id="contact-matrix"><strong>Contact Matrix</strong><a class="anchor" aria-label="anchor" href="#contact-matrix"></a></h2>
<p>A contact matrix typically consists of rows and columns representing
different age groups, where each cell indicates the average number of
contacts between individuals of the age group corresponding to that row
and column.</p>
<p>Although we do not have a direct access for contact matrix for
Burkina Faso, we can resort for a hypothetical contact matrix based on
general assumptions about high contact rates among younger populations
and lower rates among older age groups:</p>
<table style="width:98%;" class="table"><caption>Table for a <strong>hypothetical</strong> mean contacts between
different age groups in Burkina Faso population.</caption>
<colgroup><col width="17%"><col width="15%"><col width="17%"><col width="17%"><col width="17%"><col width="13%"></colgroup><thead><tr class="header"><th></th>
<th align="left"><strong>[0-15)</strong></th>
<th align="left"><strong>[15-25)</strong></th>
<th align="left"><strong>[25-54)</strong></th>
<th align="left"><strong>[55-65)</strong></th>
<th align="left"><strong>65+</strong></th>
</tr></thead><tbody><tr class="odd"><td><strong>[0-15)</strong></td>
<td align="left">20</td>
<td align="left">10</td>
<td align="left">5</td>
<td align="left">2</td>
<td align="left">1</td>
</tr><tr class="even"><td><strong>[15-25)</strong></td>
<td align="left">10</td>
<td align="left">15</td>
<td align="left">10</td>
<td align="left">4</td>
<td align="left">2</td>
</tr><tr class="odd"><td><strong>[25-55)</strong></td>
<td align="left">5</td>
<td align="left">10</td>
<td align="left">15</td>
<td align="left">6</td>
<td align="left">3</td>
</tr><tr class="even"><td><strong>[55-65)</strong></td>
<td align="left">2</td>
<td align="left">4</td>
<td align="left">6</td>
<td align="left">10</td>
<td align="left">5</td>
</tr><tr class="odd"><td><strong><span class="math inline">\(65+\)</span></strong></td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">3</td>
<td align="left">5</td>
<td align="left">10</td>
</tr></tbody></table><div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Initial conditions: one in every 1 million is infected</span></span>
<span><span class="va">bf_pop</span> <span class="op">&lt;-</span> <span class="fl">22.67e6</span></span>
<span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  <span class="fu">c</span><span class="op">(</span></span>
<span>    <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="co"># Contacts from 0-14 years</span></span>
<span>    <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">10</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="co"># Contacts from 15-24 years</span></span>
<span>    <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">6</span>, <span class="fl">3</span>, <span class="co"># Contacts from 25-54 years</span></span>
<span>    <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="co"># Contacts from 55-64 years</span></span>
<span>    <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span></span>
<span>  <span class="op">)</span>, <span class="co"># Contacts from 65+ years</span></span>
<span>  nrow <span class="op">=</span> <span class="fl">5</span>, <span class="co"># Number of rows</span></span>
<span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Fill the matrix by rows</span></span>
<span>  dimnames <span class="op">=</span> <span class="fu">list</span><span class="op">(</span></span>
<span>    <span class="fu">c</span><span class="op">(</span><span class="st">"[0-15)"</span>, <span class="st">"[15-25)"</span>, <span class="st">"[25-55)"</span>, <span class="st">"[55-65)"</span>, <span class="st">"65+"</span><span class="op">)</span>,</span>
<span>    <span class="fu">c</span><span class="op">(</span><span class="st">"[0-15)"</span>, <span class="st">"[15-25)"</span>, <span class="st">"[25-55)"</span>, <span class="st">"[55-65)"</span>, <span class="st">"65+"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Define the demography vector for Burkina Faso</span></span>
<span><span class="va">demography_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.44</span>, <span class="fl">0.195</span>, <span class="fl">0.29</span>, <span class="fl">0.05</span>, <span class="fl">0.025</span><span class="op">)</span> <span class="op">*</span> <span class="va">bf_pop</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">demography_vector</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">rownames</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="va">demography_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [0-15) [15-25) [25-55) [55-65)     65+
9974800 4420650 6574300 1133500  566750 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># scale the contact matrix so the largest eigenvalue is 1.0</span></span>
<span><span class="co"># this is to ensure that the overall epidemic dynamics correctly reflect</span></span>
<span><span class="co"># the assumed value of R0</span></span>
<span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="va">contact_matrix</span> <span class="op">/</span> <span class="fu">max</span><span class="op">(</span><span class="fu">Re</span><span class="op">(</span><span class="fu">eigen</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># divide each row of the contact matrix by the corresponding demography</span></span>
<span><span class="co"># this reflects the assumption that each individual in group {j} make contacts</span></span>
<span><span class="co"># at random with individuals in group {i}</span></span>
<span><span class="va">contact_matrix</span> <span class="op">&lt;-</span> <span class="va">contact_matrix</span> <span class="op">/</span> <span class="va">demography_vector</span></span>
<span></span>
<span><span class="co"># Print the contact matrix</span></span>
<span><span class="co"># contact_matrix</span></span>
<span></span>
<span><span class="co"># Define the population structure for Burkina Faso</span></span>
<span><span class="va">initial_i</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">bf_pop</span></span>
<span><span class="va">initial_conditions</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>S <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">initial_i</span>, E <span class="op">=</span> <span class="fl">0</span>, I <span class="op">=</span> <span class="va">initial_i</span>, R <span class="op">=</span> <span class="fl">0</span>, V <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Replicate initial conditions for all age groups</span></span>
<span><span class="va">initial_conditions_matrix</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span></span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span>,</span>
<span>  <span class="va">initial_conditions</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rownames</span><span class="op">(</span><span class="va">initial_conditions_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">rownames</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the initial conditions</span></span>
<span><span class="co"># initial_conditions_matrix</span></span>
<span></span>
<span><span class="co"># Create the population object</span></span>
<span><span class="va">bf_population</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">population</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Burkina Faso"</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="va">contact_matrix</span>,</span>
<span>  demography_vector <span class="op">=</span> <span class="va">demography_vector</span>,</span>
<span>  initial_conditions <span class="op">=</span> <span class="va">initial_conditions_matrix</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the population object</span></span>
<span><span class="co"># bf_population</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the epidemic model</span></span>
<span><span class="va">output1</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">bf_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="fl">15</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># R0/infectious period = 15/5 = 3</span></span>
<span>  infectiousness_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">8</span>, <span class="co"># 1/latent period (pre-infectious phase)</span></span>
<span>  recovery_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># 1/infectious period</span></span>
<span>  time_end <span class="op">=</span> <span class="fl">120</span>, <span class="co"># Simulation over 120 days</span></span>
<span>  increment <span class="op">=</span> <span class="fl">1</span> <span class="co"># Daily increments</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the epidemic curve</span></span>
<span><span class="va">output1</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"exposed"</span>, <span class="st">"infectious"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span>,</span>
<span>    col <span class="op">=</span> <span class="va">demography_group</span>,</span>
<span>    linetype <span class="op">=</span> <span class="va">compartment</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, name <span class="op">=</span> <span class="st">"Age group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span>, lineheight <span class="op">=</span> <span class="fl">121</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"Compartment"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span>,</span>
<span>    caption <span class="op">=</span></span>
<span>      <span class="fu">expression</span><span class="op">(</span></span>
<span>        <span class="fu">paste</span><span class="op">(</span></span>
<span>          <span class="st">"SEIR model showing the trajectories of the number of "</span>,</span>
<span>          <span class="st">"exposed and infected individuals "</span>,</span>
<span>          <span class="fu">italic</span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span>, <span class="st">" = 15 for different age groups."</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/BF_measles-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
<div class="section level2">
<h2 id="effective-reproduction-number-mathcalr_eff">Effective Reproduction Number (<span class="math inline">\(\mathcal{R}_{eff}\)</span>)<a class="anchor" aria-label="anchor" href="#effective-reproduction-number-mathcalr_eff"></a></h2>
<p>Age-structured models account for heterogeneous characteristics in
the population, such as:</p>
<ul><li>Demographic differences in social contacts,</li>
<li>Variations in demographic distribution, and</li>
<li>Differences in susceptibility to infection.</li>
</ul><p>These factors result in different <span class="math inline">\(\mathcal{R}_0\)</span> values for each age group.
The <strong>effective reproduction number</strong> <span class="math inline">\(\mathcal{R}_{eff}\)</span> represents the overall
reproduction number across all age groups while accounting for these
differences. It is calculated using the following formula:</p>
<p><span id="eq-reff"><span class="math display">\[
\begin{equation}
\mathcal{R}_{eff} = \rho(C) \lambda \gamma
\end{equation}
\qquad(5)\]</span></span></p>
<p>Where:</p>
<ul><li><p><span class="math inline">\(\rho(C)\)</span> is the
<strong>largest eigenvalue</strong> of the contact matrix <span class="math inline">\(C\)</span>, which is derived from the social
contact patterns, scaled by the population distribution across different
demographic and susceptibility groups.</p></li>
<li><p><span class="math inline">\(\lambda\)</span> is the <strong>force
of infection</strong>, which measures the rate at which susceptible
individuals are infected. This is distinct from the effective
transmission rate, often denoted as <span class="math inline">\(\beta\)</span>.</p></li>
<li><p><span class="math inline">\(\gamma\)</span> represents the
<strong>infectious period</strong>, which is the average duration an
individual remains infectious.</p></li>
</ul><p>The <a href="https://github.com/epiverse-trace/finalsize" class="external-link">finalsize</a>package implements <a href="#eq-reff">Equation 5</a>, and we can use it to calculate the <span class="math inline">\(\mathcal{R}_{eff}\)</span> for our age-structured
model, as follows:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r0</span> <span class="op">&lt;-</span> <span class="fl">15</span> <span class="co">#  basic reproduction number</span></span>
<span></span>
<span><span class="co"># define the number of age and susceptibility groups</span></span>
<span><span class="va">n_demo_grps</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">demography_vector</span><span class="op">)</span></span>
<span><span class="va">n_risk_grps</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># In this example, risk varies across groups</span></span>
<span><span class="va">susceptibility</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0.80</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_demo_grps</span>, ncol <span class="op">=</span> <span class="va">n_risk_grps</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># risk does not vary within groups</span></span>
<span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="fu">matrix</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">n_demo_grps</span>, ncol <span class="op">=</span> <span class="va">n_risk_grps</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># p_susceptibility rows must sum to 1.0</span></span>
<span><span class="va">p_susceptibility</span> <span class="op">&lt;-</span> <span class="va">p_susceptibility</span> <span class="op">/</span> <span class="fu">rowSums</span><span class="op">(</span><span class="va">p_susceptibility</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">reff</span> <span class="op">&lt;-</span> <span class="fu">finalsize</span><span class="fu">::</span><span class="fu">r_eff</span><span class="op">(</span></span>
<span>  r0 <span class="op">=</span> <span class="va">r0</span>,</span>
<span>  contact_matrix <span class="op">=</span> <span class="va">contact_matrix</span>,</span>
<span>  demography_vector <span class="op">=</span> <span class="va">demography_vector</span>,</span>
<span>  susceptibility <span class="op">=</span> <span class="va">susceptibility</span>,</span>
<span>  p_susceptibility <span class="op">=</span> <span class="va">p_susceptibility</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">reff</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8.529089</code></pre>
</div>
<div class="section level3 alert alert-secondary">
<h3 id="question">Question<a class="anchor" aria-label="anchor" href="#question"></a></h3>
<p><span class="math inline">\(\mathcal{R}_{eff}\)</span> vs <span class="math inline">\(\mathcal{R}_0\)</span>: How different is the <span class="math inline">\(\mathcal{R}_{eff}\)</span> value from <span class="math inline">\(\mathcal{R}_0\)</span>?</p>
</div>
<p><span class="math inline">\(\mathcal{R}_{eff}\)</span> more
accurately reflects the transmission potential because it takes into
account both the inherent transmissibility of the pathogen and the
actual state of susceptibility in the population.</p>
</div>
</div>
<div class="section level1">
<h1 id="interventions-models">Interventions models<a class="anchor" aria-label="anchor" href="#interventions-models"></a></h1>
<p>Interventions against measles include prevention, control, and
treatment. Controlling its spread requires a combination of public
health measures, such as reducing contact (e.g., curfew and school
closures in <a href="https://en.wikipedia.org/wiki/2019_Samoa_measles_outbreak" class="external-link">Samoa</a>),
and vaccination. In this section, we will simulate the SEIR model with
interventions using the <code>{epidemics}</code> package.</p>
<div class="section level2">
<h2 id="contacts-reduction-model">Contacts Reduction Model<a class="anchor" aria-label="anchor" href="#contacts-reduction-model"></a></h2>
<p>Reducing contact by a certain percentage impacts the transmission
rate. This reduction can be achieved through measures such as
quarantine, limiting public gatherings, and regular screening in
healthcare settings. To include such interventions in the baseline SEIR
model, the <code>{epidemics}</code> package provides an object called
<code>interventions</code>, which is added to the model definition as
shown in the code chunk below. We assume that a school closure will
reduce the frequency of contacts within and between different age
groups. We assume that school closures will reduce the contact between
school-aged children (aged 0-15) by 0.5 and will cause a small reduction
(0.01) in the contact between adults (aged 15 and over).</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reduced_contacts</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">intervention</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"school closure"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"contacts"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">30</span> <span class="op">+</span> <span class="fl">60</span>,</span>
<span>  reduction <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the epidemic model</span></span>
<span><span class="va">output2</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">bf_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="fl">15</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># R0/infectious period = 15/5 = 3</span></span>
<span>  infectiousness_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">8</span>, <span class="co"># 1/latent period (pre-infectious phase)</span></span>
<span>  recovery_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># 1/infectious period</span></span>
<span>  intervention <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>contacts <span class="op">=</span> <span class="va">reduced_contacts</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">120</span>, <span class="co"># Number of days to simulate </span></span>
<span>  increment <span class="op">=</span> <span class="fl">1</span> <span class="co"># Daily increments</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>To examine the effect that implementing a reduction in contact has on
the daily number of new infections, we plot the results from the two
models.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract new infections data for each scenario</span></span>
<span><span class="va">data_baseline</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">new_infections</span><span class="op">(</span><span class="va">output1</span>, by_group <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data_reduced</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">new_infections</span><span class="op">(</span><span class="va">output2</span>, by_group <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign scenario names</span></span>
<span><span class="va">data_baseline</span><span class="op">$</span><span class="va">scenario</span> <span class="op">&lt;-</span> <span class="st">"Baseline"</span></span>
<span><span class="va">data_reduced</span><span class="op">$</span><span class="va">scenario</span> <span class="op">&lt;-</span> <span class="st">"Reduced Contact"</span></span>
<span></span>
<span><span class="co"># Combine the data from both scenarios</span></span>
<span><span class="va">data_combined</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">data_baseline</span>, <span class="va">data_reduced</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot new infections over time with scenario and demographic groups</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data_combined</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">new_infections</span>,</span>
<span>      col <span class="op">=</span> <span class="va">demography_group</span>, linetype <span class="op">=</span> <span class="va">scenario</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Set axis scaling and formatting</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_linetype_manual</span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Scenario"</span>,</span>
<span>    values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>      Baseline <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      <span class="st">"Reduced Contact"</span> <span class="op">=</span> <span class="st">"solid"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_brewer</span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Age Group"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation Time (days)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"New Infections"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"Scenario"</span>,</span>
<span>    caption <span class="op">=</span></span>
<span>      <span class="fu">expression</span><span class="op">(</span></span>
<span>        <span class="fu">paste</span><span class="op">(</span></span>
<span>          <span class="st">"New infections under baseline and reduced transmission rate ("</span>,</span>
<span>          <span class="va">beta</span>,</span>
<span>          <span class="st">") for different age groups."</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Adjust legend display to fit in two rows</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/BF_measles-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
<div class="section level2">
<h2 id="vaccination-model">Vaccination Model<a class="anchor" aria-label="anchor" href="#vaccination-model"></a></h2>
<p>An effective vaccine for measles exists, known as the measles, mumps,
and rubella (MMR) vaccine, and many countires, including <a href="https://www.unicef.org/media/155306/file/Burkina-Faso-Humanitarian-SitRep-31-March-2024.pdf" class="external-link">Burkina
Faso</a>, incorporates it as part of their national immunization
strategy. The effect of vaccination with MMR vaccine varies slightly
depending on the vaccination rate per age at which it is administered
and the number of doses received. For example, let us say the 2-doses
MMR vaccination rate is approximately <span class="math inline">\(0.01\)</span>, <span class="math inline">\(0.02\)</span>, <span class="math inline">\(0.03\)</span>, <span class="math inline">\(0.04\)</span>, and <span class="math inline">\(0.05\)</span> for the age groups <span class="math inline">\([0\to 15)\)</span>, <span class="math inline">\([15\to 25)\)</span>, <span class="math inline">\([25\to 55)\)</span>, <span class="math inline">\([55\to 65)\)</span>, and <span class="math inline">\(65+\)</span>, respectively. The
<code>{epidemics}</code> package enables the incorporation of
vaccination interventions into modeling, as demonstrated in the code
chunk below.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vaccinate_elders</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">vaccination</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Vaccination compaign"</span>,</span>
<span>  time_begin <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">30</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fl">90</span>, <span class="fu">nrow</span><span class="op">(</span><span class="va">contact_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nu <span class="op">=</span> <span class="fu">matrix</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the epidemic model</span></span>
<span><span class="va">output3</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">bf_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="fl">15</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># R0/infectious period = 15/5 = 3</span></span>
<span>  infectiousness_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">8</span>, <span class="co"># 1/latent period (pre-infectious phase)</span></span>
<span>  recovery_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># 1/infectious period</span></span>
<span>  vaccination <span class="op">=</span> <span class="va">vaccinate_elders</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">120</span>, <span class="co"># Simulation over 120 days</span></span>
<span>  increment <span class="op">=</span> <span class="fl">1</span> <span class="co"># Daily increments</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the epidemic curve</span></span>
<span><span class="va">output3</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="st">"exposed"</span>, <span class="st">"infectious"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">value</span>,</span>
<span>    col <span class="op">=</span> <span class="va">demography_group</span>,</span>
<span>    linetype <span class="op">=</span> <span class="va">compartment</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, name <span class="op">=</span> <span class="st">"Age group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span>, lineheight <span class="op">=</span> <span class="fl">121</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation time (days)"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"Compartment"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Individuals"</span>,</span>
<span>    caption <span class="op">=</span></span>
<span>      <span class="fu">expression</span><span class="op">(</span></span>
<span>        <span class="fu">paste</span><span class="op">(</span></span>
<span>          <span class="st">"SEIR with vaccine  showing the trajectories of the number of "</span>,</span>
<span>          <span class="st">"exposed and infected individuals for different age groups."</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/BF_measles-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can visualize the outcomes of both the baseline model and the
vaccine-intervention model to highlight the differences in infection
dynamics. This comparison allows us to observe how vaccination impacts
the spread of the disease, particularly in terms of reducing new
infections, altering the epidemic curve, and potentially preventing
outbreaks across different age groups. By contrasting these two models,
we can better understand the effectiveness of vaccination strategies in
controlling the epidemic.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load new infections data for each scenario</span></span>
<span><span class="va">data_vaccine</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">new_infections</span><span class="op">(</span></span>
<span>  <span class="va">output3</span>,</span>
<span>  compartments_from_susceptible <span class="op">=</span> <span class="st">"vaccinated"</span>,</span>
<span>  by_group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign scenario names</span></span>
<span><span class="va">data_vaccine</span><span class="op">$</span><span class="va">scenario</span> <span class="op">&lt;-</span> <span class="st">"Vaccination"</span></span>
<span></span>
<span><span class="co"># Combine the data from both scenarios (baseline and vaccination)</span></span>
<span><span class="va">data_combined2</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">data_baseline</span>, <span class="va">data_vaccine</span><span class="op">)</span></span>
<span><span class="co"># Plot new infections over time by scenario and demographic groups</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data_combined2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot new infections with lines for each demographic group and scenario</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time</span>,</span>
<span>      y <span class="op">=</span> <span class="va">new_infections</span>,</span>
<span>      col <span class="op">=</span> <span class="va">demography_group</span>,</span>
<span>      linetype <span class="op">=</span> <span class="va">scenario</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Scale the y-axis with comma-formatted labels</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Define custom line types for scenarios</span></span>
<span>  <span class="fu">scale_linetype_manual</span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"Scenario"</span>,</span>
<span>    values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span></span>
<span>      Baseline <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      Vaccination <span class="op">=</span> <span class="st">"solid"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Use a color palette for age groups</span></span>
<span>  <span class="fu">scale_colour_brewer</span><span class="op">(</span></span>
<span>    palette <span class="op">=</span> <span class="st">"Dark2"</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Age Group"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Set axis limits and disable automatic expansion</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Apply a clean white background theme</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Customize theme for better aesthetics</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>, <span class="co"># Position legend at the top</span></span>
<span>    legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="co"># Adjust legend text size</span></span>
<span>    plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># Center align the caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add axis labels and caption for the plot</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation Time (days)"</span>, <span class="co"># x-axis label</span></span>
<span>    y <span class="op">=</span> <span class="st">"New Infections"</span>, <span class="co"># y-axis label</span></span>
<span>    linetype <span class="op">=</span> <span class="st">"Scenario"</span>, <span class="co"># Legend title for line types</span></span>
<span>    caption <span class="op">=</span> <span class="fu">expression</span><span class="op">(</span></span>
<span>      <span class="fu">paste</span><span class="op">(</span></span>
<span>        <span class="st">"New infections under baseline and vaccine-induced immunity"</span>,</span>
<span>        <span class="st">"with varying efficacy ("</span>,</span>
<span>        <span class="va">nu</span>, <span class="st">") across different age groups."</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Adjust legend display for better readability</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># Split legend into two rows</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/BF_measles-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
<div class="section level2">
<h2 id="combining-interventions">Combining interventions<a class="anchor" aria-label="anchor" href="#combining-interventions"></a></h2>
<p>The <code>{epidemics}</code> package enables the integration of
multiple interventions, such as vaccination and contact reduction,
within a single model, allowing for more comprehensive simulations of
disease control strategies. The below code chunk shows how to combine
interventions together.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the epidemic model</span></span>
<span><span class="va">output4</span> <span class="op">&lt;-</span> <span class="fu">epidemics</span><span class="fu">::</span><span class="fu">model_default</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">bf_population</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="fl">15</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># R0 / infectious period = 3</span></span>
<span>  infectiousness_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">8</span>, <span class="co"># 1 / latent period (pre-infectious phase)</span></span>
<span>  recovery_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5</span>, <span class="co"># 1 / infectious period</span></span>
<span>  intervention <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>contacts <span class="op">=</span> <span class="va">reduced_contacts</span><span class="op">)</span>,</span>
<span>  vaccination <span class="op">=</span> <span class="va">vaccinate_elders</span>,</span>
<span>  time_end <span class="op">=</span> <span class="fl">120</span>, <span class="co"># Number of days to simulate</span></span>
<span>  increment <span class="op">=</span> <span class="fl">1</span> <span class="co"># Daily increments</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the epidemic curve (infectious individuals)</span></span>
<span><span class="va">output4</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"infectious"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Filter for infectious individuals</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">time</span>, <span class="co"># Time on the x-axis</span></span>
<span>    y <span class="op">=</span> <span class="va">value</span>, <span class="co"># Number of infectious individuals on the y-axis</span></span>
<span>    col <span class="op">=</span> <span class="va">demography_group</span> <span class="co"># Color by demographic group (age)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Line width for better visibility</span></span>
<span>  <span class="co"># Format y-axis with commas for thousands</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Color palette for age groups</span></span>
<span>  <span class="fu">scale_colour_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, name <span class="op">=</span> <span class="st">"Age Group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Ensure the y-axis starts from 0 and goes up to 500,000</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.5e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Disable axis expansion</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Clean, white background theme</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>, <span class="co"># Place legend at the top</span></span>
<span>    <span class="co"># Adjust text size and line height</span></span>
<span>    legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span>, lineheight <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># Center align the caption</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Simulation Time (Days)"</span>, <span class="co"># x-axis label</span></span>
<span>    y <span class="op">=</span> <span class="st">"Number of Infectious Individuals"</span>, <span class="co"># y-axis label</span></span>
<span>    caption <span class="op">=</span> <span class="st">"SEIR model with vaccination and contact reduction:</span></span>
<span><span class="st">    Number of infectious individuals by age group"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Split the legend into two rows for compactness</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/BF_measles-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 --></div>
</div>



      </div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/tutorials-late/edit/main/learners/BF_measles.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/tutorials-late/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace/tutorials-late/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials-late/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/tutorials-late/instructor/BF_measles.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "epidemic models, interventions",
  "name": "Introduction to Mathematical Modelling of Infectious Diseases",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials-late/instructor/BF_measles.html",
  "identifier": "https://epiverse-trace.github.io/tutorials-late/instructor/BF_measles.html",
  "dateCreated": "2025-04-01",
  "dateModified": "2025-04-15",
  "datePublished": "2025-04-15"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

